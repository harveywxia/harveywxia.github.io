<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://harveywxia.github.io</id>
    <title>harveyçš„ç½‘ç»œæ—¥å¿—</title>
    <updated>2021-08-27T07:53:45.938Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://harveywxia.github.io"/>
    <link rel="self" href="https://harveywxia.github.io/atom.xml"/>
    <subtitle>æ¸©æ•…è€ŒçŸ¥æ–°</subtitle>
    <logo>https://harveywxia.github.io/images/avatar.png</logo>
    <icon>https://harveywxia.github.io/favicon.ico</icon>
    <rights>All rights reserved 2021, harveyçš„ç½‘ç»œæ—¥å¿—</rights>
    <entry>
        <title type="html"><![CDATA[Githubæ­å»ºä¸ªäººä¸»é¡µ]]></title>
        <id>https://harveywxia.github.io/post/github-da-jian-ge-ren-zhu-ye/</id>
        <link href="https://harveywxia.github.io/post/github-da-jian-ge-ren-zhu-ye/">
        </link>
        <updated>2021-08-27T06:27:39.000Z</updated>
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°">æ¦‚è¿°</h2>
<p>GitHub Pageså¯ä»¥ç”¨æ¥æ‰˜ç®¡ä¸ªäººé™æ€ç½‘ç«™ï¼Œä¾¿äºç”¨æ¥å®ç°åšå®¢ã€‚</p>
<h2 id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œ</h2>
<ul>
<li>Gthubè´¦å·</li>
<li>åŸŸå(å¯é€‰)</li>
</ul>
<h2 id="github-pages">Github Pages</h2>
<p>æ–°å»ºä¸€ä¸ªä»“åº“ï¼Œå‘½åæ ¼å¼å¦‚ä¸‹ï¼š</p>
<pre><code>{ç”¨æˆ·æ˜}.github.io
</code></pre>
<p>éœ€è¦é€‰æ‹©publicï¼ˆå…¬å¼€ï¼‰<br>
è¿›å…¥åˆ°è¯¥ä»“åº“çš„settingèœå•ï¼ˆåœ¨starä¸‹é¢ï¼‰ä¸­ã€‚å¯ä»¥é€‰æ‹©å¹¶å¼€å¯ã€‚<br>
æ­¤æ—¶åœ¨æµè§ˆå™¨ä¸­å³å¯è®¿é—®é¡µé¢ï¼Œä½†æ˜¯å¦‚æœæƒ³æ›´å¥½çš„ç®¡ç†ï¼Œå¯ä»¥ä½¿ç”¨Grideaã€‚</p>
<h2 id="gridea">Gridea</h2>
<p>Grideaæ˜¯ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨æœ¬åœ°ï¼Œæ²¡æœ‰æ•°æ®åº“ï¼Œå®ç°ç®€å•ï¼Œæ”¯æŒMarkdownã€‚<br>
å®˜ç½‘ä¸‹è½½Grideaï¼Œå®‰è£…å¹¶è¿›å…¥è®¾ç½®é¡µé¢<br>
<img src="https://harveywxia.github.io/post-images/1630046301998.png" alt="" loading="lazy"></p>
<p>åŸŸåä¸ä»“åº“åä¸€æ ·,åˆ†æ”¯å¡«master,emailè‡ªå·±å¡«,è¿™é‡Œè¯´ä¸€ä¸‹Token.æ‰“å¼€è®¾ç½®ä¸­çš„å¼€å‘è€…è®¾ç½®:<br>
å³ä¸Šè§’å¤´åƒ--&gt;Settings --&gt;Developer settings --&gt;Personal access tokens--&gt;Generate token  å‹¾é€‰repoç„¶åå¤åˆ¶tokenå³å¯ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h2>
<ol>
<li><a href="https://www.cnblogs.com/6b7b5fc3/p/12716218.html">Github Pages+Grideaæ­å»ºä¸ªäººåšå®¢</a></li>
<li><a href="https://www.jianshu.com/p/1520e4872a2c">ã€ŒGrideaã€ç»™åˆæ¥è§¦è€…çš„ä¸€äº›ä½¿ç”¨æŠ€å·§</a></li>
</ol>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Redmineé…ç½®]]></title>
        <id>https://harveywxia.github.io/post/redmine-pei-zhi/</id>
        <link href="https://harveywxia.github.io/post/redmine-pei-zhi/">
        </link>
        <updated>2020-05-23T13:13:39.000Z</updated>
        <content type="html"><![CDATA[<h3 id="é—®é¢˜çŠ¶æ€">é—®é¢˜çŠ¶æ€</h3>
<p>é—®é¢˜çŠ¶æ€æ ‡ç­¾ï¼šæ–°å»ºé—®é¢˜ã€æ–°å»ºã€è¿›è¡Œä¸­ã€å·²è§£å†³ã€åé¦ˆã€å·²å…³é—­ã€å·²æ‹’ç»ã€æŒ‚èµ·ã€‚</p>
<ul>
<li><a href="https://www.cnblogs.com/biaopei/p/8891004.html">redmineæ·»åŠ è‡ªå®šä¹‰é—®é¢˜çŠ¶æ€</a></li>
</ul>
<h3 id="è·Ÿè¸ªæ ‡ç­¾">è·Ÿè¸ªæ ‡ç­¾</h3>
<p>è·Ÿè¸ªæ ‡ç­¾ï¼šé‡Œç¨‹ç¢‘ã€ä»»åŠ¡ã€éœ€æ±‚ç”¨ä¾‹ã€åŠŸèƒ½ã€ç¼ºé™·<br>
é¡¹ç›®ä¸­å„è·Ÿè¸ªæ ‡ç­¾çš„ç»“æ„å…³ç³»<br>
<img src="https://harveywxia.github.io/post-images/1590239926975.jpg" alt="" loading="lazy"><br>
è¯´æ˜ï¼š<br>
ã€€ã€€1ï¼  5ä¸ªé‡Œç¨‹ç¢‘ï¼šéœ€æ±‚åˆ†æã€æ¦‚è¦è®¾è®¡ã€åŠŸèƒ½å¼€å‘ã€ç³»ç»Ÿæµ‹è¯•ã€ç³»ç»Ÿéƒ¨ç½²<br>
ã€€ã€€2ï¼ åœ¨â€œéœ€æ±‚åˆ†æâ€ã€â€œæ¦‚è¦è®¾è®¡â€ã€â€œç³»ç»Ÿæµ‹è¯•â€ã€â€œéƒ¨ç½²ä¸Šçº¿â€ è¿™å‡ ä¸ªé‡Œç¨‹ç¢‘ä¸­ä¸»è¦æ˜¯ä»¥â€œä»»åŠ¡â€çš„å½¢å¼æŒ‡æ´¾ç»™é¡¹ç›®æˆå‘˜<br>
ã€€ã€€3ï¼ â€œåŠŸèƒ½å¼€å‘â€è¿™ä¸ªé‡Œç¨‹ç¢‘ä¸­æœ‰æ¶‰åŠåˆ°â€œéœ€æ±‚ç”¨ä¾‹â€â€œåŠŸèƒ½â€â€œä»»åŠ¡â€â€œç¼ºé™·â€<br>
ã€€ã€€4.   è‹¥åŠŸèƒ½åˆ’åˆ†çš„ä¸å¤Ÿç»†ï¼Œåˆ™å¯å°†å…¶ä»¥ä»»åŠ¡çš„å½¢å¼å†æ¬¡åˆ’åˆ†ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[CentOS7å®‰è£…redmine]]></title>
        <id>https://harveywxia.github.io/post/centos7-an-zhuang-redmine/</id>
        <link href="https://harveywxia.github.io/post/centos7-an-zhuang-redmine/">
        </link>
        <updated>2020-05-23T11:55:35.000Z</updated>
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹">ç®€ä»‹</h2>
<p>Redmineæ˜¯ç”¨Rubyå¼€å‘çš„åŸºäºwebçš„é¡¹ç›®ç®¡ç†è½¯ä»¶ï¼Œæ˜¯ç”¨RORæ¡†æ¶å¼€å‘çš„ä¸€å¥—è·¨å¹³å°é¡¹ç›®ç®¡ç†ç³»ç»Ÿï¼Œé€šè¿‡â€œé¡¹ç›®ï¼ˆProjectï¼‰â€çš„å½¢å¼æŠŠæˆå‘˜ã€ä»»åŠ¡ï¼ˆé—®é¢˜ï¼‰ã€æ–‡æ¡£ã€è®¨è®ºä»¥åŠå„ç§å½¢å¼çš„èµ„æºç»„ç»‡åœ¨ä¸€èµ·ï¼Œå¤§å®¶å‚ä¸æ›´æ–°ä»»åŠ¡ã€æ–‡æ¡£ç­‰å†…å®¹æ¥æ¨åŠ¨é¡¹ç›®çš„è¿›åº¦ï¼ŒåŒæ—¶ç³»ç»Ÿåˆ©ç”¨æ—¶é—´çº¿ç´¢å’Œå„ç§åŠ¨æ€çš„æŠ¥è¡¨å½¢å¼æ¥è‡ªåŠ¨ç»™æˆå‘˜æ±‡æŠ¥é¡¹ç›®è¿›åº¦ã€‚</p>
<h2 id="å®‰è£…æµç¨‹">å®‰è£…æµç¨‹</h2>
<h3 id="dockerç¯å¢ƒå®‰è£…">dockerç¯å¢ƒå®‰è£…</h3>
<h4 id="å¸è½½æ—§ç‰ˆæœ¬">å¸è½½æ—§ç‰ˆæœ¬</h4>
<p>è¾ƒæ—§çš„ Docker ç‰ˆæœ¬ç§°ä¸º docker æˆ– docker-engine ã€‚å¦‚æœå·²å®‰è£…è¿™äº›ç¨‹åºï¼Œè¯·å¸è½½å®ƒä»¬ä»¥åŠç›¸å…³çš„ä¾èµ–é¡¹ã€‚</p>
<pre><code class="language-sh">$ sudo yum remove docker \
                  docker-client \
                  docker-client-latest \
                  docker-common \
                  docker-latest \
                  docker-latest-logrotate \
                  docker-logrotate \
                  docker-engine
</code></pre>
<h4 id="å®‰è£…docker">å®‰è£…docker</h4>
<p><strong>ä¾èµ–ç¯å¢ƒ</strong><br>
yum-utils æä¾›äº† yum-config-manager ï¼Œå¹¶ä¸” device mapper å­˜å‚¨é©±åŠ¨ç¨‹åºéœ€è¦ device-mapper-persistent-data å’Œ lvm2ã€‚</p>
<pre><code class="language-sh">$ sudo yum install -y yum-utils \
  device-mapper-persistent-data \
  lvm2
</code></pre>
<p><strong>å®‰è£… Docker Engine-Community</strong><br>
å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Docker Engine-Community å’Œ containerd.</p>
<pre><code class="language-sh">$ sudo yum install docker-ce docker-ce-cli containerd.io
</code></pre>
<p><strong>å¯åŠ¨ Docker</strong></p>
<pre><code class="language-sh">$ sudo systemctl start docker
</code></pre>
<p><strong>æµ‹è¯•</strong><br>
é€šè¿‡è¿è¡Œ hello-world æ˜ åƒæ¥éªŒè¯æ˜¯å¦æ­£ç¡®å®‰è£…äº† Docker Engine-Community ã€‚</p>
<pre><code class="language-sh">$ sudo docker run hello-world
</code></pre>
<p>è¿è¡Œä»¥ä¸Šå‘½ä»¤ä¼šæ‰“å°å‡ºhello-worldã€‚</p>
<h4 id="å®‰è£…docker-compose">å®‰è£…docker-compose</h4>
<p>è¿™é‡Œé€‰æ‹©ä½¿ç”¨pipå®‰è£…ï¼Œpipçš„å®‰è£…è¿‡ç¨‹è¿™é‡Œä¸å±•å¼€ã€‚<br>
ä½¿ç”¨pipå®‰è£…æ—¶å»ºè®®ä½¿ç”¨<code>virtulenv</code>ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼š</p>
<pre><code class="language-sh">pip install docker-compose
</code></pre>
<p>å¦‚æœä½ ä¸ä½¿ç”¨virtulenvï¼Œåˆ™éœ€è¦è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå®Œæˆå®‰è£…ã€‚</p>
<pre><code class="language-sh">sudo pip install docker-compose
</code></pre>
<p><strong>æµ‹è¯•</strong></p>
<pre><code class="language-sh">docker-compose -version
</code></pre>
<p>ä¼šæ‰“å°å‡ºç›¸å…³ç‰ˆæœ¬ä¿¡æ¯ã€‚<br>
<strong>å‚è€ƒ</strong></p>
<ul>
<li><a href="https://docs.docker.com/compose/install/">Install Docker Compose</a></li>
</ul>
<h3 id="å®‰è£…redmine">å®‰è£…redmine</h3>
<pre><code class="language-yaml">version: '3'
services:
  redmine:
      image: redmine:4.1.1-alpine
      restart: always
      ports:
          - '8080:3000'
      environment:
          REDMINE_DB_MYSQL: mysql
          REDMINE_DB_PASSWORD: redminemysql
          REDMINE_SECRET_KEY_BASE: supersecretkey
      volumes:
        - '/usr/harvey/docker/redmine/redmine_dir:/usr/src/redmine/files'

  mysql:
      image: mysql:8.0.20
      restart: always
      environment:
        MYSQL_ROOT_PASSWORD: redminemysql
        MYSQL_DATABASE: redmine
      volumes:
        - '/usr/harvey/docker/redmine/mysql__dir:/var/lib/mysql'
</code></pre>
<p><strong>å‚è€ƒ</strong></p>
<ul>
<li><a href="https://hub.docker.com/_/redmine">dockerhub-redmine</a></li>
</ul>
<h2 id="æµ‹è¯•">æµ‹è¯•</h2>
<p>æµè§ˆå™¨ä¸­è¾“å…¥ä»¥ä¸‹ç½‘å€ï¼Œ<br>
http://localhost:8080/login<br>
è¿›å…¥ç™»å½•ç•Œé¢ï¼Œé»˜è®¤ç”¨æˆ·å/å¯†ç ï¼šadmin/admin</p>
<p>å¼€å§‹ä½ çš„redmineä¹‹æ—…å§ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Django rest framework ä½¿ç”¨ç¬”è®°  ]]></title>
        <id>https://harveywxia.github.io/post/django-rest-framework-shi-yong-bi-ji/</id>
        <link href="https://harveywxia.github.io/post/django-rest-framework-shi-yong-bi-ji/">
        </link>
        <updated>2020-04-25T09:55:35.000Z</updated>
        <content type="html"><![CDATA[<h2 id="modelså±‚">modelså±‚</h2>
<h3 id="models-field">models field</h3>
<p>åœ¨modelä¸­æ·»åŠ å­—æ®µçš„æ ¼å¼ä¸€èˆ¬ä¸ºï¼š  field_name = field_type(**field_options)</p>
<h4 id="field-optionsæ‰€æœ‰å­—æ®µå…±ç”¨">field options(æ‰€æœ‰å­—æ®µå…±ç”¨)</h4>
<ol>
<li>null   é»˜è®¤ä¸ºFalseï¼ŒTrueåˆ™è¡¨ç¤ºå¯ä»¥ä¸ºnullã€‚ï¼ˆç©ºå­—ç¬¦ä¸²åœ¨æ•°æ®åº“ä¸­å¯èƒ½è¢«å­˜å‚¨ä¸º''ï¼‰</li>
<li>blank  é»˜è®¤ä¸ºFalseï¼ŒTrueè¡¨ç¤ºå¯ä»¥ä¸ºç©ºã€‚</li>
<li>choice  å¯é€‰çš„ï¼Œé™åˆ¶äº†è¯¥é€‰é¡¹çš„å­—æ®µå€¼å¿…é¡»æ˜¯æ‰€æŒ‡å®šçš„choiceä¸­çš„ä¸€ä¸ªã€‚</li>
</ol>
<pre><code class="language-python">from django.db import models

class Student(models.Model):
    FRESHMAN = 'FR'
    SOPHOMORE = 'SO'
    JUNIOR = 'JR'
    SENIOR = 'SR'
    YEAR_IN_SCHOOL_CHOICES = (
        (FRESHMAN, 'Freshman'),      #ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯çœŸæ­£çš„modelå‚æ•°ï¼Œ#ç¬¬äºŒä¸ªå‚æ•°åˆ™æ˜¯æ–¹ä¾¿äººä»¬ç†è§£é˜…è¯»
        (SOPHOMORE, 'Sophomore'),
        (JUNIOR, 'Junior'),
        (SENIOR, 'Senior'),
    )
    year_in_school = models.CharField(
        max_length=2,
        choices=YEAR_IN_SCHOOL_CHOICES,
        default=FRESHMAN,
    )

    def is_upperclass(self):
        return self.year_in_school in (self.JUNIOR, self.SENIOR)
</code></pre>
<ol start="4">
<li><code>db_column</code>: æ•°æ®åº“<code>column</code>åç§°ã€‚é»˜è®¤ä¸ºæœ¬å­—æ®µçš„åç§°;</li>
<li><code>db_index</code>: å¦‚æœä¸º<code>True</code>çš„è¯ï¼Œè¯¥å­—æ®µçš„æ•°æ®åº“ç´¢å¼•å°†ä¼šè¢«åˆ›å»º;</li>
<li><code>default</code>: è®¾ç½®è¯¥å­—æ®µçš„é»˜è®¤å€¼ï¼Œå¯ä»¥æ˜¯å€¼ä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡;</li>
<li><code>editable</code>: é»˜è®¤ä¸º<code>True</code>ï¼Œè‹¥ä¸º<code>False</code>ï¼Œåˆ™ä¸ä¼šåœ¨<code>admin</code>ç•Œé¢æ˜¾ç¤º;</li>
<li><code>primary_key</code>: è‹¥è®¾ç½®ä¸º<code>True</code>ï¼Œåˆ™è¡¨ç¤ºå°†è¯¥å­—æ®µè®¾ç½®ä¸ºä¸»é”®ã€‚ä¸€èˆ¬æƒ…å†µä¸‹<code>django</code>é»˜è®¤ä¼šè®¾ç½®ä¸€ä¸ªè‡ªå¢é•¿çš„idä¸»é”®;</li>
<li><code>unique</code>: è‹¥è®¾ç½®ä¸º<code>True</code>ï¼Œè¯¥å­—æ®µå€¼ä¸å¯é‡å¤.</li>
</ol>
<p><strong><code>field type</code>(å­—æ®µç±»å‹)</strong></p>
<h4 id="modelsåŸºç¡€å­—æ®µ">modelsåŸºç¡€å­—æ®µ</h4>
<p><code>AutoField()</code><br>
æ ¹æ®å·²æœ‰<code>id</code>è‡ªå¢é•¿çš„æ•´å½¢å”¯ä¸€å­—æ®µï¼Œä¸€èˆ¬æ¯ä¸ª<code>model</code>ç±»ä¸éœ€è®¾ç½®è¯¥å­—æ®µï¼Œå› ä¸º<code>django</code>ä¼šä¸ºæ¯ä¸ª<code>model</code>è‡ªåŠ¨è®¾ç½®ã€‚<br>
<code>django</code>é»˜è®¤ä¼šä¸ºæ¯ä¸ª<code>model</code>ç±»æ·»åŠ å¦‚ä¸‹è¯­å¥ï¼š</p>
<pre><code>id = models.AutoField(primary_key=True)
</code></pre>
<p>å½“å…¶ä»–å­—æ®µæ·»åŠ äº†<code>primary_key</code>å±æ€§ï¼Œåˆ™ä¸ä¼šåˆ›å»º<code>id</code>å­—æ®µäº†,æ¯ä¸ª<code>model</code>ç±»ä»…èƒ½æœ‰ä¸€ä¸ªä¸»é”®.</p>
<p><code>BooleanField()</code><br>
å¸ƒå°”å‹å­—æ®µï¼Œé»˜è®¤çš„è¡¨å•çª—å£éƒ¨ä»¶æ˜¯<code>CheckBoxInput</code></p>
<p><code>CharField()</code><br>
å­—ç¬¦å‹å­—æ®µï¼Œé»˜è®¤çš„è¡¨å•çª—å£éƒ¨ä»¶æ˜¯<code>TextInput</code>ã€‚è¯¥å­—æ®µç±»å‹æœ‰ä¸€ä¸ªå¿…éœ€å‚æ•°ï¼š<br>
<code>max_length</code>  åœ¨æ•°æ®åº“æ°´å¹³é™å®šäº†å­—ç¬¦ä¸²æœ€å¤§é•¿åº¦</p>
<p><code>DateField()</code><br>
æ—¥æœŸå­—æ®µï¼Œå­—æ®µçš„å€¼æ˜¯<code>python</code>ä¸­<code>datetime.date</code>çš„å®ä¾‹ï¼Œé»˜è®¤çš„è¡¨å•çª—å£æ˜¯<code>TextInput</code>æœ‰å‡ ä¸ªå¯é€‰çš„å‚æ•°ï¼š</p>
<p><code>auto_now=True/False</code>: å½“è®¾ç½®ä¸ºTrueæ—¶ï¼Œæ¯å½“è¯¥å¯¹è±¡ä½¿ç”¨save()æ—¶ï¼Œè¯¥å­—æ®µçš„å€¼å°±ä¼šè¢«æ›´æ–°ã€‚<br>
<code>auto_now_add=True/False</code>: å½“è®¾ç½®ä¸ºTrueæ—¶ï¼Œè¯¥å­—æ®µçš„å€¼ä¸ºè¯¥å¯¹è±¡è¢«åˆ›å»ºæ—¶çš„æ—¥æœŸ</p>
<p><code>DateTimeField()</code><br>
æ—¥æœŸå’Œæ—¶é—´å­—æ®µï¼Œå€¼ä¸º<code>datetime.datetime</code>å®ä¾‹ã€‚é»˜è®¤çš„è¡¨å•çª—å£ä»¥åŠå¯é€‰å‚æ•°åŒä¸Šã€‚</p>
<p><code>DecimalField()</code><br>
æ··åˆç²¾åº¦çš„å°æ•°å‹æ•°å­—å­—æ®µã€‚æœ‰ä¸¤ä¸ªå¿…éœ€çš„å‚æ•°ï¼š<br>
<code>max_digits=ingt_number</code>:é™å®šæ•°å­—çš„æœ€å¤§ä½æ•°ï¼ˆåŒ…å«å°æ•°ä½ï¼‰<br>
<code>decimal_places=int_number</code>:å­˜å‚¨æ•°å­—çš„å°æ•°ä½</p>
<pre><code>#to store numbers up to 999 with a resolution of 2 decimal places, youâ€™d use
models.DecimalField(..., max_digits=5, decimal_places=2)
</code></pre>
<p><code>EmailField(max_length=254, **options)</code><br>
é‚®ä»¶å­—æ®µï¼Œä½¿ç”¨<code>EmailValidator</code>è¿›è¡ŒéªŒè¯</p>
<p><code>FileField(upload_to=None, max_length=100, **options)</code><br>
æ–‡ä»¶ä¸Šä¼ å­—æ®µã€‚è¿™ä¸ªå­—æ®µä¸èƒ½è®¾ç½®<code>primary_key</code>å’Œ<code>unique</code>é€‰é¡¹.åœ¨æ•°æ®åº“ä¸­å­˜å‚¨ç±»å‹æ˜¯<code>varchar</code>ï¼Œé»˜è®¤æœ€å¤§é•¿åº¦ä¸º100.<br>
æœ‰ä¸¤ä¸ªå¯é€‰å‚æ•°ï¼š<br>
<code>upload_to</code>: å¦‚æœä½¿ç”¨é»˜è®¤çš„FileSystomStorageï¼Œæ–‡ä»¶å°†ä¼šå­˜å‚¨åˆ°settingsæ–‡ä»¶ä¸­é…ç½®çš„MEDIA_ROOTè·¯å¾„ä¸­ã€‚upload_toçš„å€¼ä¹Ÿå¯ä»¥ä¸ºå¯è°ƒç”¨å¯¹è±¡,é€šè¿‡è°ƒç”¨è¿™ä¸ªå¯¹è±¡å¯ä»¥è·å¾—ä¸Šä¼ è·¯å¾„ã€‚<br>
instance=:  å®šä¹‰äº†FileFieldçš„æ¨¡å‹å®ä¾‹<br>
filename='':  æ–‡ä»¶åç§°ã€‚</p>
<pre><code class="language-python">class MyModel01(models.Model):
    # file will be uploaded to MEDIA_ROOT/uploads
    upload = models.FileField(upload_to='uploads/')
    # or...
    # file will be saved to MEDIA_ROOT/uploads/2015/01/30
    upload = models.FileField(upload_to='uploads/%Y/%m/%d/')

#upload_to=å¯è°ƒç”¨å¯¹è±¡
def user_directory_path(instance, filename):
    # file will be uploaded to MEDIA_ROOT/user_&lt;id&gt;/&lt;filename&gt;
    return 'user_{0}/{1}'.format(instance.user.id, filename)

class MyModel02(models.Model):
    upload = models.FileField(upload_to=user_directory_path)
</code></pre>
<p>storage  ç”¨æ¥è®¾å®šæ–‡ä»¶å­˜å‚¨ä»“åº“</p>
<p><code>FilePathField(path=None, match=None, recursive=False, max_length=100, **options)</code><br>
è¿™ä¸ªå­—æ®µçš„å€¼è¢«é™åˆ¶åœ¨ç³»ç»Ÿä¸ŠæŸä¸ªç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶åé›†åˆä¸­ã€‚æœ‰ä¸‰ä¸ªå‚æ•°:</p>
<p>path='':  è¯¥å‚æ•°å¿…éœ€ã€‚ä¸Šè¡Œæ‰€è¯´çš„'æŸä¸ªç›®å½•â€™çš„ç»å¯¹è·¯å¾„ã€‚Example: &quot;/home/images&quot;.<br>
match='pattern':  å¯é€‰å‚æ•°ã€‚æ ¼å¼æ˜¯æ­£åˆ™è¡¨è¾¾å¼ã€‚ç”¨æ¥æ‹£é€‰ç¬¦åˆåŒ¹é…æ­£åˆ™è¡¨è¾¾å¼çš„æ–‡ä»¶<br>
recursive=True/False: å¯é€‰å‚æ•°ï¼Œé»˜è®¤ä¸ºFalseã€‚è®¾å®šæ˜¯å¦é€’å½’è¯¥ç›®å½•ä¸‹æ‰€æœ‰å­ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶ã€‚</p>
<pre><code class="language-python">FilePathField(path=&quot;/home/images&quot;, match=&quot;foo.*&quot;, recursive=True)
</code></pre>
<p><code>FloatField()</code><br>
æµ®ç‚¹å­—æ®µï¼Œé»˜è®¤çš„è¡¨å•çª—å£éƒ¨ä»¶æ˜¯<code>NumberInput</code>ã€‚å’Œ<code>DecimalField</code>ç»å¸¸æ··æ·†ä¸æ¸…ï¼Œ<code>FloatField</code>åœ¨å†…éƒ¨ä½¿ç”¨<code>Python</code>ä¸­çš„<code>float</code>å¯¹è±¡ï¼Œè€Œ<code>DecimalField</code>åœ¨å†…éƒ¨ä½¿ç”¨<code>Python</code>ä¸­çš„<code>decimal</code>å¯¹è±¡ã€‚</p>
<p><code>ImageField(upload_to=None, height_field=None, width_field=None, max_length=100, **options)</code></p>
<p>å›¾åƒå­—æ®µã€‚ç»§æ‰¿äº†<code>FileField</code>çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ã€‚è€Œä¸”è¿˜èƒ½è‡ªåŠ¨éªŒè¯ä¸Šä¼ çš„å¯¹è±¡æ˜¯å¦ä¸ºåˆæ³•çš„å›¾åƒã€‚</p>
<p><code>IntegerField()</code><br>
æ•´å‹å­—æ®µã€‚</p>
<p><code>GenericIPAddressField(protocol='both', unpack_ipv4=False, **options)</code><br>
ipåœ°å€å­—æ®µ<br>
<code>protocol='both/ipv4/ipv6'</code>:  é»˜è®¤ä¸ºboth<br>
<code>unpack_ipv4</code>:  ç”¨å¤„ä¸å¤§ã€‚</p>
<p><code>NullBooleanField()</code><br>
ç±»ä¼¼äº<code>BooleanField</code>ï¼Œä¸åŒçš„æ˜¯å…¶å…è®¸å€¼ä¸º<code>null</code></p>
<p><code>TextField()</code><br>
ä¸<code>CharField</code>ç±»ä¼¼ï¼Œä½†ä¸€èˆ¬ç”¨æ¥å­˜å‚¨ä½“ç§¯è¾ƒå¤§çš„æ–‡æœ¬ã€‚</p>
<p>TimeField(auto_now=False, auto_now_add=False, **options)`<br>
æ—¶é—´å­—æ®µï¼Œå…¶å€¼ä¸ºdatetime.timeå®ä¾‹</p>
<p>URLField(max_length=200, **options)<code>URLå­—æ®µ, ç±»ä¼¼äº</code>CharField`çš„å­ç±»ï¼Œé»˜è®¤æœ€å¤§é•¿åº¦ä¸º200.</p>
<p>UUIDField(**options)<code>é€šç”¨å”¯ä¸€æ ‡è¯†å­—æ®µï¼Œå½“ä¸æƒ³ç”¨</code>django<code>é»˜è®¤è®¾ç½®çš„</code>AutoField`å­—æ®µæ—¶ï¼Œå¯ä»¥ç”¨è¯¥å­—æ®µä»£æ›¿ã€‚</p>
<h4 id="å…³ç³»å­—æ®µ">å…³ç³»å­—æ®µ</h4>
<p><strong>1. ä¸€å¯¹ä¸€</strong>ï¼š  ç°åœ¨æœ‰å¾ˆå¤šä¸€å¯¹ä¸€è¾…å¯¼ç­ï¼Œä¹Ÿå°±æ˜¯ä¸Šè¯¾æ—¶ï¼Œä¸€ä¸ªè€å¸ˆå¯¹åº”ä¸€ä¸ªå­¦ç”Ÿï¼Œä¸€ä¸ªå­¦ç”Ÿå¯¹åº”ä¸€ä¸ªè€å¸ˆ<br>
ã€€ã€€<strong>2. å¤šå¯¹ä¸€</strong>ï¼š  å¾ˆå¤šåè¿œå±±åŒºçš„å­¦æ ¡å¯èƒ½æ•´ä¸ªå­¦æ ¡åªæœ‰ä¸€ä¸ªè€å¸ˆï¼Œè¿™ä¸€ä¸ªè€å¸ˆå¯¹åº”å¤šä¸ªå­¦ç”Ÿï¼Œæ‰€æœ‰çš„å­¦ç”Ÿå¯¹åº”è¿™ä¸€ä¸ªè€å¸ˆ<br>
ã€€ã€€<strong>3. å¤šå¯¹å¤š</strong>ï¼š  è€Œæˆ‘ä»¬åˆ™å¾ˆå¹¸ç¦ï¼Œå­¦æ ¡é‡Œæœ‰è®¸å¤šè€å¸ˆï¼Œä¸€ä¸ªè€å¸ˆæ•™ä¹ ä¸€ç§‘ï¼Œå­¦ç”Ÿæœ‰å¤šä¸ªè€å¸ˆï¼Œè€å¸ˆæœ‰å¤šä¸ªå­¦ç”Ÿã€‚</p>
<h5 id="foreignkeyothermodel-on_delete-options">ForeignKey(othermodel, on_delete, **options)</h5>
<p>ç”¨äºå¤šå¯¹ä¸€æˆ–è€…ä¸€å¯¹å¤šæˆ–è€…å¤–é”®å­—æ®µ:<br>
<code>othermodel</code>ï¼š  æ‰€å…³è”çš„æ¨¡å‹ï¼Œ'å¤š' modelä½¿ç”¨å¤–é”®å…³è”  'ä¸€'modelã€‚<br>
å½“æ‰€å…³è”çš„æ¨¡å‹ä¸ºä»–è‡ªå·±æ—¶ï¼Œä½¿ç”¨'self';<br>
å½“å¼•ç”¨çš„æ¨¡å‹ä¸ºå…¶ä»–appä¸­çš„æ¨¡å‹æ—¶ï¼Œè¦åŠ ä¸Šappåç§°æ ‡ç­¾:  'app_name.model_name';<br>
æ•°æ®åº“ä¼šè‡ªåŠ¨åœ¨å¤–é”®å­—æ®µä¸Šåˆ›å»ºç´¢å¼•ï¼Œå¯ä»¥ä½¿ç”¨de_index=Falseå…³é—­è¯¥åŠŸèƒ½ã€‚<br>
<code>on_delete</code>ï¼š å½“åˆ é™¤ &quot;ä¸€&quot; æ¨¡å‹å¯¹è±¡æ—¶ï¼Œdjangoä¼šæ ¹æ®è¯¥å‚æ•°çš„å€¼å¯¹ä¸è¯¥å¯¹è±¡ç›¸å…³è”çš„å…¶ä»–å¯¹è±¡(ä¹Ÿå°±æ˜¯ 'å¤šâ€™)è¿›è¡Œæ“ä½œã€‚<br>
<em>åœ¨django1.9ä»¥åŠä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œon_deleteä½œä¸ºä¸€ä¸ªå…³é”®å­—å‚æ•°ã€‚è€Œåœ¨1.10åˆ™å¯ä»¥ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°</em><br>
<code>models.CASCADE</code>ï¼š   é»˜è®¤ä¸ºmodels.CASCADE   çº§è”åˆ é™¤ã€‚å½“åˆ é™¤'ä¸€'æ—¶ï¼Œ'å¤šâ€™ä¼šè¢«åˆ é™¤ã€‚æ¯”å¦‚ï¼š</p>
<pre><code class="language-python"># mysiteé¡¹ç›®ä¸‹åä¸ºpollsçš„appä¸­çš„models.py
class follower(models.Model):
    name = models.CharField(max_length=200)
    menpai = models.ForeignKey('menpai', on_delete=models.CASCADE)  #å®šä¹‰äº†models.CASCADEå±æ€§

    def __str__(self):
        return self.name

class menpai(models.Model):
    name = models.CharField(max_length=200)

    def __str__(self):
        return self.name

#è¿è¡Œ python3 manager.py shellè¿›å…¥äº¤äº’é¡µé¢
&gt;&gt;&gt; from polls.models import follower,menpai
&gt;&gt;&gt; m1=menpai(name='huashanpai')   
&gt;&gt;&gt; m1.save()
&gt;&gt;&gt; m2=menpai(name='riyuejiao')
&gt;&gt;&gt; m2.save()
&gt;&gt;&gt; f1=follower(name='linghuchong',menpai=m1)
&gt;&gt;&gt; f1.save()
&gt;&gt;&gt; f2=follower(name='renwoxing',menpai=m2)
&gt;&gt;&gt; f2.save()
&gt;&gt;&gt; f1.menpai
&lt;menpai: huashanpai&gt;
&gt;&gt;&gt; m1.delete()
(2, {'polls.menpai': 1, 'polls.follower': 1})   # åˆ é™¤åå±±æ´¾æ—¶ï¼Œå°†ä»¤ç‹å†²ä¹Ÿåˆ é™¤äº†
</code></pre>
<p><code>modles.PROTECT</code> : å½“åˆ é™¤ä¸€ä¸ªå…·æœ‰å¤–é”®å…³ç³»çš„å¯¹è±¡æ—¶ï¼Œä¼šå¼•å‘ä¸€ä¸ªå¼‚å¸¸ï¼Œé˜»æ­¢åˆ é™¤è¯¥å¯¹è±¡<br>
<code>models.SET_NULL</code>: è®¾ç½®åˆ é™¤å¯¹è±¡æ‰€å…³è”çš„å¤–é”®å­—æ®µä¸ºnullã€‚ä½†å­—æ®µçš„nullå±æ€§å¿…éœ€ä¸ºTrue<br>
<code>models.SET_DEFAULT</code> : è®¾ç½®åˆ é™¤å¯¹è±¡æ‰€å…³è”çš„å¤–é”®å­—æ®µä¸ºé»˜è®¤çš„å€¼ã€‚<br>
<code>models.SET(value)</code>ï¼šè®¾ç½®åˆ é™¤å¯¹è±¡æ‰€å…³è”çš„å¯¹è±¡çš„å¤–é”®å­—æ®µä¸ºvalue,valueä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå¯è°ƒç”¨å‡½æ•°ã€‚</p>
<pre><code class="language-python">from django.conf import settings
from django.contrib.auth import get_user_model
from django.db import models

def get_sentinel_user():
    return get_user_model().objects.get_or_create(username='deleted')[0]

class MyModel(models.Model):
    user = models.ForeignKey(
        settings.AUTH_USER_MODEL,
        on_delete=models.SET(get_sentinel_user),
    )
</code></pre>
<p><code>models.DO_NOTHING</code>: ä¸åšä»»ä½•æ“ä½œ<br>
<code>limit_choices_to</code>: é™åˆ¶è¯¥å­—æ®µä¸ºé€‰é¡¹å½¢ã€‚æ ¼å¼ï¼š<code>limit_choices_to={'is_staff': True}</code>ã€‚å€¼ä¹Ÿå¯ä»¥ä¸ºå¯è°ƒç”¨å‡½æ•°ã€‚</p>
<pre><code class="language-python">def limit_pub_date_choices():
    return {'pub_date__lte': datetime.date.utcnow()}

limit_choices_to = limit_pub_date_choices
</code></pre>
<p><code>related_name</code>  è®¾ç½®ä»å…³è”å¯¹è±¡åˆ°è‡ªèº«çš„å…³ç³»çš„åç§°ï¼Œè‹¥å€¼ä¸º'+'  åˆ™å…³è”å¯¹è±¡ä¸è‡ªèº«æ— é€†å‘å…³ç³»ã€‚è¯¦è§£è¯·çœ‹å®˜æ–¹æ–‡æ¡£ã€‚ä¸¾ä¾‹ï¼š<br>
<code>related_name</code>çš„ä½œç”¨æ˜¯åœ¨åå‘å¼•ç”¨çš„æ—¶å€™ï¼Œå°±æ˜¯é€šè¿‡Userå»æ‰¾<code>Employee</code>çš„æ—¶å€™ï¼Œç”¨<code>User.user_employee</code>ï¼Œå¼•æ–‡å…³é”®è¯å«ï¼š<code>reverse accessor</code>ã€‚</p>
<pre><code class="language-python">class Employee(generic.BO):
    user = models.OneToOneField(User,verbose_name=_(&quot;ç™»å½•è´¦æˆ·&quot;),blank=True,null=True,on_delete=models.CASCADE,related_name='user_employee')
</code></pre>
<p><code>to_field</code>  è®¾ç½®æ‰€å…³è”å¯¹è±¡çš„å…³è”å­—æ®µã€‚é»˜è®¤ä¸ºå…³è”å¯¹è±¡çš„ä¸»é”®å­—æ®µã€‚</p>
<p><a href="https://blog.csdn.net/djskl/article/details/42041767">OneToOneFieldå’ŒForeignKeyæœ‰ä»€ä¹ˆåŒºåˆ«</a></p>
<h5 id="manytomanyfieldothermodel-options">ManyToManyField(othermodel, **options)</h5>
<p>å¤šå¯¹å¤šå­—æ®µã€‚</p>
<p><code>othermodel</code>:  æ‰€å…³è”çš„modelåç§°;<br>
<code>db_table</code>:  å¤šå¯¹å¤šå…³ç³»ä¼šåœ¨ä¸¤ä¸ªæ¨¡å‹æ‰€å¯¹åº”çš„è¡¨ä¸­é—´åˆ›å»ºä¸€ä¸ª'ä¸­é—´è¡¨â€™ ï¼Œå°†å¤šå¯¹å¤šè½¬æ¢ä¸ºä¸¤ä¸ªå¤šå¯¹ä¸€ï¼Œè¯¥é€‰é¡¹ä¸ºè¿™ä¸ªä¸­é—´è¡¨è®¾ç½®åç§°ã€‚ä¸€èˆ¬æ¥è¯´djangoä¼šé»˜è®¤ä¸ºä¸­é—´è¡¨åˆ›å»ºåç§°ï¼Œä½†äººä»¬è¯»èµ·æ¥å¯èƒ½æä¸æ¸…æ¥šç©¶ç«Ÿä¸­é—´è¡¨å…³è”åˆ°äº†å“ªé‡Œ;<br>
<code>related_name</code>:  åŒå¤šå¯¹ä¸€å­—æ®µä¸­çš„related_name;<br>
<code>limite_choices_to</code>:  åŒ....;<br>
<code>symmetrical</code>:  å½“å¤šå¯¹å¤šå…³è”å¯¹è±¡ä¸ºè‡ªèº«æ—¶å¯èƒ½ä¼šç”¨åˆ°çš„å‚æ•°ã€‚é»˜è®¤ä¸ºTrueã€‚a,båŒå±äºpersonæ¨¡å‹ï¼Œpersonä¸­çš„friendså­—æ®µä¸è‡ªèº«è®¾ç½®äº†å¤šå¯¹å¤šå…³ç³»ï¼Œå½“è¯¥å€¼è®¾ç½®ä¸ºTrueæ—¶ï¼Œdjangoå‡å®šå…³ç³»ä¸ºå¯¹ç§°ï¼Œå³ï¼šaæ˜¯bçš„æœ‹å‹ï¼Œé‚£ä¹ˆbä¹Ÿæ˜¯açš„æœ‹å‹ã€‚è®¾ç½®ä¸ºFalseæ—¶ï¼Œdjangoä¼šå¼ºåˆ¶ä¸ºé€†å‘å…³ç³»åˆ›å»ºæè¿°ä¿¡æ¯;<br>
<code>though</code>:  ä¸æƒ³è®©djangoè‡ªåŠ¨åˆ›å»ºä¸­é—´è¡¨ï¼Œæ‰‹åŠ¨åˆ›å»ºä¸­é—´è¡¨æ‰€å¯¹åº”çš„modelï¼Œé€šè¿‡thoughæŒ‡å®šå¯¹åº”çš„modelåç§°;<br>
<code>though_field</code>:  å½“thoughå‚æ•°è¢«ä½¿ç”¨æ—¶ï¼Œè¯¥å‚æ•°æ‰ä¼šæœ‰æ•ˆã€‚æŒ‡å®šä½¿ç”¨å“ªäº›ä¸­é—´æ¨¡å‹å­—æ®µæ¥ç¡®ç«‹ä¸¤ä¸ªæ¨¡å‹çš„å¤šå¯¹å¤šå…³ç³»;</p>
<h5 id="onetoonefieldothermodel-on_delete-parent_linkfalse-options">OneToOneField(othermodel, on_delete, parent_link=False, **options)</h5>
<p>ä¸€å¯¹ä¸€å­—æ®µã€‚<br>
othermodel: .......<br>
on_delete:........<br>
related_name:...........<br>
<strong>å‚è€ƒèµ„æ–™</strong></p>
<ol>
<li><a href="https://stackoverflow.com/questions/27668064/fail-to-post-onetoonefield-with-django-rest">Fail to POST OneToOneField with Django REST</a></li>
<li><a href="https://docs.djangoproject.com/en/2.1/ref/models/fields/">å‚è€ƒ</a></li>
</ol>
<p><strong>å…³è”</strong><br>
<strong>å…³è”æœªå®šä¹‰çš„Model</strong><br>
å¦‚æœä½ è¦ä¸æŸä¸ªå°šæœªå®šä¹‰çš„modelå»ºç«‹å…³è”ï¼Œå°±ä½¿ç”¨modelçš„åç§°ï¼Œè€Œä¸æ˜¯ä½¿ç”¨modelå¯¹è±¡æœ¬èº«ã€‚</p>
<pre><code class="language-python">class Book(models.Model):
    pub = models.ForeignKey('Publisher')
</code></pre>
<p><strong>å…³è”è‡ªèº«</strong><br>
å¯ä»¥ä¸è‡ªèº«å»ºç«‹å¤šå¯¹ä¸€æˆ–è€…ä¸€å¯¹ä¸€å…³ç³»ã€‚</p>
<pre><code class="language-python">class People(models.Model):
    name=models.CharField(max_length=20)
    leader=models.ForeignKey('self',blank=True,null=True)

class Person(models.Model):
    friends = models.ManyToManyField(&quot;self&quot;)

//é€šè¿‡shellæ·»åŠ å…³ç³»
&gt;&gt;&gt;p1.friends.add(p2,p3)
</code></pre>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ç§å…³è”å…³ç³»æ˜¯å¯¹ç§°çš„ï¼Œå¦‚æœ<code>person1</code>æ˜¯<code>person2</code>çš„æœ‹å‹ï¼Œé‚£ä¹ˆ<code>person2</code>ä¹Ÿæ˜¯<code>person1</code>çš„æœ‹å‹ï¼Œè¦æŸ¥æ‰¾<code>person2</code>çš„æ‰€æœ‰æœ‹å‹å¯ä»¥ç›´æ¥ä½¿ç”¨<code>person2.friends.all()</code>ã€‚<br>
å¦‚æœè¦å–æ¶ˆè¿™ç§å¯¹ç§°å…³ç³»ï¼Œå¯ä»¥å°†<code>symmetrical</code>è®¾ç½®ä¸ºFalseï¼š</p>
<pre><code class="language-python">class Person2(models.Model):
    friends=models.ManyToManyField(&quot;self&quot;,symmetrical=False)
</code></pre>
<p>è¿™æ ·æŸ¥è¯¢p3çš„æœ‹å‹ï¼Œå°±éœ€è¦<code>p3.person_set.all()</code>äº†<br>
<strong>åå‘åç§°related_name</strong><br>
åå‘åç§°ç”¨æ¥ä»è¢«å…³è”å­—æ®µæŒ‡å‘å…³è”å­—æ®µã€‚</p>
<pre><code class="language-python">class Book(models.Model):
Â  Â  name=models.CharField(max_length=20)
Â  Â  pub=models.ForeignKey(Publisher,related_name='pub')
Â  Â  authors=models.ManyToManyField(Author,related_name='author')
</code></pre>
<p>è¿™æ ·ç”¨Publisheræˆ–è€…Authoråå‘æŸ¥è¯¢Bookæ—¶å¯ä»¥ç”¨related_nameäº†:<code>publisher1.pub.all()</code>æˆ–è€…<code>author1.author.all()</code>ã€‚<br>
å¦‚æœä¸æƒ³è®¾ç½®åå‘å…³å¿ƒï¼Œåˆ™è®¾ç½®<code>related_name</code>ä¸º<code>'+'</code>æˆ–è€…ä»¥<code>'+'</code>ç»“æŸã€‚<br>
<code>user = models.ForeignKey(User, related_name='+')</code><br>
å¦‚æœæœ‰å¤šä¸ª<code>ManyToManyField</code>æŒ‡å‘åŒä¸€ä¸ªModelï¼Œè¿™æ ·åå‘æŸ¥è¯¢FOO_setçš„æ—¶å€™å°±æ— æ³•å¼„æ¸…æ˜¯å“ªä¸ªManyToManyFieldå­—æ®µäº†ï¼Œæ‰€ä»¥å¯ä»¥ç¦æ­¢åå‘å…³ç³»ï¼š</p>
<pre><code class="language-python">users = models.ManyToManyField(User, related_name='u+')
referents = models.ManyToManyField(User, related_name='ref+')
</code></pre>
<p><a href="https://blog.csdn.net/Crow_n/article/details/58135127?utm_source=blogxgwz7">å‚è€ƒ</a></p>
<h2 id="è®¤è¯å’Œæƒé™">è®¤è¯å’Œæƒé™</h2>
<p><code>settings.py</code>è®¾ç½®é»˜è®¤çš„è®¤è¯æ–¹å¼å’Œæƒé™ã€‚</p>
<pre><code class="language-python">REST_FRAMEWORK = {
    # å…¨å±€ï¼Œé»˜è®¤è®¤è¯
    'DEFAULT_AUTHENTICATION_CLASSES': (
        'rest_framework.authentication.SessionAuthentication',
        'rest_framework.authentication.BasicAuthentication',
        # 'rest_framework.authentication.TokenAuthentication',
    ),
    # å…¨å±€ï¼Œé»˜è®¤æƒé™
    'DEFAULT_PERMISSION_CLASSES': (
        'rest_framework.permissions.IsAuthenticated',
    ),
}
</code></pre>
<h3 id="django-rest-auth">django-rest-auth</h3>
<p><code>django-rest-auth</code>ç”¨æˆ·ç®¡ç†appï¼Œ<a href="https://django-rest-auth.readthedocs.io/en/latest/api_endpoints.html">ç½‘å€</a></p>
<h4 id="ç”¨æˆ·ç®¡ç†">ç”¨æˆ·ç®¡ç†</h4>
<h5 id="ç™»é™†">ç™»é™†</h5>
<pre><code>/rest-auth/login/ (POST)

username
email
password
Returns Token key
</code></pre>
<h5 id="ç™»å‡º">ç™»å‡º</h5>
<pre><code>/rest-auth/logout/ (POST)
</code></pre>
<h5 id="é‡ç½®å¯†ç ">é‡ç½®å¯†ç </h5>
<pre><code>/rest-auth/password/reset/ (POST)
email
</code></pre>
<h5 id="ç¡®è®¤å¯†ç ">ç¡®è®¤å¯†ç </h5>
<pre><code>/rest-auth/password/reset/confirm/ (POST)

uid
token
new_password1
new_password2
</code></pre>
<p><strong>Note</strong>:<code>uid</code>å’Œ<code>token</code>æ˜¯è¯·æ±‚é‡ç½®å¯†ç æ¥å£<code>/rest-auth/password/reset/</code>è¿”å›çš„</p>
<h5 id="ä¿®æ”¹å¯†ç ">ä¿®æ”¹å¯†ç </h5>
<pre><code>/rest-auth/password/change/ (POST)

new_password1
new_password2
old_password
</code></pre>
<h5 id="æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯">æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯</h5>
<pre><code>/rest-auth/user/ (GET, PUT, PATCH)

username
first_name
last_name
Returns pk, username, email, first_name, last_name
</code></pre>
<h5 id="æ³¨å†Œ">æ³¨å†Œ</h5>
<pre><code>/rest-auth/registration/ (POST)

username
password1
password2
email
</code></pre>
<h5 id="ç¡®è®¤">ç¡®è®¤</h5>
<pre><code>/rest-auth/registration/verify-email/ (POST)

key
</code></pre>
<h3 id="è‡ªå®šä¹‰ç”¨æˆ·è®¤è¯">è‡ªå®šä¹‰ç”¨æˆ·è®¤è¯</h3>
<p><strong>BaseAuthentication</strong>ç±»ï¼š<br>
<code>django rest-framework</code> é€šè¿‡<code>BaseAuthentication</code> å®ç°è®¤è¯åŠŸèƒ½,æ— è®ºæ˜¯è‡ªå®šä¹‰çš„è®¤è¯ç±»è¿˜æ˜¯<code>rest-framework</code>è‡ªå¸¦çš„è®¤è¯ç±»éƒ½åº”è¯¥ç»§æ‰¿<code>BaseAuthentication</code>.<code>BaseAuthentication</code> ä¸­æœ‰ä¸¤ä¸ªæ–¹æ³•<code>authenticate</code>å’Œ<code>authenticate_header</code>,å…¶ä¸­<code>authenticate</code>æ–¹æ³•å¿…é¡»å®ç° å¦‚æœç”¨æˆ·éœ€è¦è‡ªå®šä¹‰è®¤è¯æ–¹æ³•åˆ™ç»§æ‰¿<code>BaseAuthentication</code>é‡å†™<code>authenticate</code>æ–¹æ³•å³å¯.</p>
<ol>
<li>æ–°å»º<code>UserToken</code><br>
ä¿®æ”¹<code>models.py</code>æ–‡ä»¶ï¼Œå¢å‡<code>UserToken</code>ç±»ï¼Œå…¶ä¸­<code>UserInfo</code>ä¹Ÿå¯ä½¿ç”¨ç³»ç»Ÿçš„Userç±»ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</li>
</ol>
<pre><code class="language-python">from django.db import models
class UserInfo(models.Model):
        user_type_choices = (
                (1, 'æ™®é€šç”¨æˆ·'),
                (2, 'VPI'),
                (3, 'SVPI'),
        )
        user_type = models.IntegerField(choices=user_type_choices)
        username = models.CharField(max_length=32, unique=True)
        password = models.CharField(max_length=64)

class UserToken(models.Model):
        user = models.OneToOneField('UserInfo', models.CASCADE)
        token = models.CharField(max_length=64)
</code></pre>
<ol start="2">
<li>æ„å»ºè®¤è¯ä»£ç <br>
æ‰“å¼€<code>APP_DIR/utils/auth.py</code>ï¼ˆè‹¥æ— ï¼Œåˆ™æ–°å»ºè¯¥æ–‡ä»¶ï¼‰ï¼Œå°†è®¤è¯ä»£ç æ”¾å…¥å…¶ä¸­ã€‚</li>
</ol>
<pre><code class="language-python">from rest_framework import exceptions
from rest_framework.authentication import BaseAuthentication
from app01 import models

# å®ç°è‡ªå®šä¹‰çš„è®¤è¯ç±»
class Authtication(BaseAuthentication):
        def authenticate(self, request):
                # è¿™å„¿çš„ request å¯¹è±¡ä¸æ˜¯ django åŸç”Ÿçš„ request è€Œæ˜¯ rest_framework å†…éƒ¨è¿›è¡Œå°è£…è¿‡çš„ request
                # ä½¿ç”¨ request._request è°ƒç”¨ django åŸç”Ÿçš„ request å¯¹è±¡
                token = request._request.GET.get('token')
                # æ£€æŸ¥ç”¨æˆ·çš„ token æ˜¯å¦åˆæ³•
                token_obj = models.UserToken.objects.filter(token=token).first()
                if not token_obj:
                        # rest_framework ä¼šåœ¨å†…éƒ¨æ•æ‰è¿™ä¸ªå¼‚å¸¸å¹¶è¿”å›ç»™ç”¨æˆ·è®¤è¯å¤±è´¥çš„ä¿¡æ¯
                        raise exceptions.AuthenticationFailed('ç”¨æˆ·è®¤è¯å¤±è´¥')
                # åœ¨ rest_framework å†…éƒ¨ä¼šå°†è¿™ä¸¤ä¸ªå­—æ®µèµ‹å€¼ç»™requestä»¥ä¾›åç»­è°ƒç”¨
                return (token_obj.user, token_obj)

</code></pre>
<ol start="3">
<li>ä¿®æ”¹<code>views.py</code>æ–‡ä»¶</li>
</ol>
<pre><code class="language-python">from django.http import JsonResponse
from rest_framework.views import APIView
from app01.utils.auth import Authtication
import hashlib
import time

# ç”Ÿæˆ token å­—ç¬¦ä¸²
def md5(user):
        ctime = str(time.time())
        m = hashlib.md5(bytes(user, encoding='utf-8'))
        m.update(bytes(ctime, encoding='utf-8'))
        return m.hexdigest()

# ç”¨æˆ·ç™»å½•
class AuthView(APIView):
        def post(self, request):
                ret = {'code':1000, 'msg':None}
                try:
                        user = request._request.POST.get('username')
                        pwd = request._request.POST.get('password')

                        obj = models.UserInfo.objects.filter(username=user, password=pwd).first()
                        if not obj:
                                ret['code'] = 1001
                                ret['msg'] = &quot;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&quot;
                        # ä¸ºç™»å½•ç”¨æˆ·åˆ›å»ºtoken
                        token = md5(user)
                        #å­˜åœ¨æ›´æ–° ä¸å­˜åœ¨åˆ›å»º
                        models.UserToken.objects.update_or_create(user=obj, defaults={'token':token})
                        ret['token'] = token
                except:
                        ret['code'] = 1002
                        ret['msg'] = 'è¯·æ±‚å¼‚å¸¸'
                return JsonResponse(ret)

# ä¸šåŠ¡ä»£ç 
class Order(APIView):
        # æ³¨å†Œè‡ªå®šä¹‰çš„è®¤è¯ç±»,ã€€å¯ä»¥æœ‰å¤šä¸ª,ã€€ä»å·¦åˆ°å³è¿›è¡Œè®¤è¯åŒ¹é…
        authentication_classes = [Authtication,]

        def get(self, request):
                # request.user  è¿™ä¸ªå€¼ç­‰äº Authtication è¿”å›çš„å…ƒç»„çš„ç¬¬ä¸€ä¸ªå€¼
                # request.auth  è¿™ä¸ªå€¼ç­‰äº Authtication è¿”å›çš„å…ƒç»„çš„ç¬¬äºŒä¸ªå€¼
                ret = {'code':1000, 'msg':None, 'data':None}
                ret['data'] = 'æ¬¢è¿ä½¿ç”¨æœ¬ç³»ç»Ÿ'
                return JsonResponse(ret)
</code></pre>
<ol start="4">
<li><code>rest_framework</code>å†…ç½®çš„è®¤è¯ç±»ï¼š</li>
</ol>
<pre><code class="language-python">BasicAuthentication             # åŸºäºæµè§ˆå™¨å®ç°çš„ Basic è®¤è¯, ftp ä½¿ç”¨ç½‘é¡µç™»å½•æ—¶ä½¿ç”¨çš„å°±æ˜¯ Basic è®¤è¯
SessionAuthentication           # åŸºäº django çš„ user.is_active è¿›è¡Œè®¤è¯
TokenAuthentication             # ç®€å•çš„åŸºäº token çš„è®¤è¯
RemoteUserAuthentication        # ç®€å•çš„è¿œç¨‹ç”¨æˆ·è®¤è¯å®ç°
</code></pre>
<p>å¯å‚è€ƒæ–‡æ¡£ï¼š<br>
<a href="https://blog.csdn.net/zzg_550413470/article/details/52239867">Django è®¤è¯ç³»ç»Ÿ</a></p>
<ol start="5">
<li>é…ç½®å…¨å±€ç”Ÿæ•ˆçš„è®¤è¯ç±»å’ŒåŒ¿åç”¨æˆ·ï¼š<br>
è‡ªå®šä¹‰çš„è®¤è¯ç±»å¦‚æœæ¯æ¬¡éƒ½åœ¨æŒ‡å®šçš„ç±»ä¸­ä½¿ç”¨<code>authentication_classes</code>æŒ‡å®š,å°±æœ‰å¯èƒ½å‡ºç°å¤§é‡çš„é‡å¤ä»£ç ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å…¨å±€è®¾ç½®è®©æŒ‡å®šçš„è®¤è¯ç±»å¯¹ç»§æ‰¿è‡ª<code>APIView</code>çš„æ‰€æœ‰ç±»ç”Ÿæ•ˆï¼Œä¿®æ”¹<code>settings.py</code>æ–‡ä»¶ã€‚</li>
</ol>
<pre><code class="language-python">REST_FRAMEWORK = {
        # è®¾ç½®å…¨å±€ç”Ÿæ•ˆçš„è®¤è¯ç±»(å¯ä»¥æœ‰å¤šä¸ª)
        # app01 ä¸º django app çš„åç§°
        # utils ä¸º app ç›®å½•ä¸‹é¢çš„ utils ç›®å½•(è¿™ä¸ªç›®å½•å¿…é¡»åŒ…å« __init__.py æ–‡ä»¶)
        # auth ä¸º utils ç›®å½•ä¸‹é¢çš„ auth.py æ–‡ä»¶
        # Authtication ä¸º auth.py æ–‡ä»¶é‡Œé¢çš„ Authtication ç±»
        # è¿™å„¿çš„è®¾ç½®å…¶å®å°±æ˜¯ä½¿ç”¨ from ... import ... çš„è·¯å¾„

        'DEFAULT_AUTHENTICATION_CLASSES': [&quot;app01.utils.auth.Authtication&quot;,],

        #åŒ¿åç”¨æˆ·é…ç½®
        'UNAUTHENTICATED_USER': None,           # è®¾ç½®åŒ¿åç”¨æˆ·çš„ç”¨æˆ·å, é»˜è®¤ä¸º AnonymousUser, ä½¿ç”¨ request.user æŸ¥çœ‹
        'UNAUTHENTICATED_TOKEN': None,          # è®¾ç½®åŒ¿åç”¨æˆ·çš„ token, é»˜è®¤ä¸º None, ä½¿ç”¨ request.auth æŸ¥çœ‹
}
</code></pre>
<ol start="6">
<li>æŒ‡å®š<code>View</code>ç±»ä¸ä½¿ç”¨å…¨å±€çš„è®¤è¯ç±»ï¼š<br>
åœ¨ä¸ä½¿ç”¨å…¨å±€è®¤è¯ç±»çš„<code>View</code>ç±»ä¸­æ·»åŠ <code>authentication_classes = []</code>æˆ–è€…``authentication_classes = ['xxxx']`</li>
</ol>
<pre><code class="language-python"># authentication_classes = [] è¡¨ç¤ºä¸ä½¿ç”¨è®¤è¯
# authentication_classes = ['xxxx'], xxxx è¡¨ç¤ºå½“å‰ç±»éœ€è¦ä½¿ç”¨çš„è®¤è¯ç±»ç”¨äºæ›¿æ¢å…¨å±€ç±»
</code></pre>
<p><a href="http://blog.51cto.com/hongchen99/2306783">å‚è€ƒé“¾æ¥</a></p>
<h2 id="é”™è¯¯">é”™è¯¯</h2>
<ol>
<li>Django Rest Framework - â€œdetailâ€: â€œNot found.â€`<br>
é‡åˆ°çš„æƒ…å†µæ˜¯urlè¢«å…¶ä»–è·¯ç”±æ‹¦æˆªã€‚</li>
<li><code>Djangoï¼šCSRF Failed: CSRF token missing or incorrect</code><br>
ç™»é™†æˆåŠŸåä¸€ç›´è¿”å›<code>Djangoï¼šCSRF Failed: CSRF token missing or incorrect</code>å…¶å®ä¸æ˜¯<code>è·¨åŸŸé—®é¢˜</code>ï¼Œè€Œæ˜¯Djangoè‡ªå¸¦çš„<em>ç”¨æˆ·éªŒè¯æœºåˆ¶</em>å¯¼è‡´ï¼Œä¸ºæ­¤æˆ‘ä»¬éœ€è¦åœ¨è¯·æ±‚å¤´é‡æ·»åŠ <code>X-CSRFToken</code>,æ­¥éª¤å¦‚ä¸‹ï¼šå°†Postmanè¿”å›çš„cookieä¸­çš„csrftokenå€¼å¤åˆ¶åˆ°è¯·æ±‚å¤´ä¸­ï¼Œ</li>
</ol>
<table>
<thead>
<tr>
<th>KEY</th>
<th>VALUE</th>
</tr>
</thead>
<tbody>
<tr>
<td>X-CSRFToken</td>
<td>cookieä¸­çš„tokenå€¼</td>
</tr>
</tbody>
</table>
<p>ä¹‹åæäº¤è¯·æ±‚å³å¯ã€‚</p>
<ol>
<li><a href="https://docs.djangoproject.com/en/2.1/ref/csrf/">å®˜ç½‘é“¾æ¥</a></li>
<li><a href="http://python.jobbole.com/89305/?utm_source=blog.jobbole.com&amp;utm_medium=relatedPosts">ç®€åŒ–djangoçš„å…«ä¸ªpythonåŒ…</a></li>
<li><a href="https://blog.csdn.net/Odyssues_lee/article/details/80948818">å‚è€ƒèµ„æ–™</a></li>
</ol>
<h2 id="æ•°æ®æŸ¥è¯¢">æ•°æ®æŸ¥è¯¢</h2>
<h3 id="django-queryset">django queryset</h3>
<p>å®ç°åŸºæœ¬çš„å¢åˆ æ”¹æŸ¥ç­‰ã€‚</p>
<ol>
<li><a href="https://feifeiyum.github.io/2017/03/28/python-django-queryset/">Django QuerySet æ–¹æ³•æ¢³ç†</a></li>
<li><a href="https://feifeiyum.github.io/2017/04/10/python-django-querysetapi/">å¸¸ç”¨ Django QuerySet Api</a></li>
</ol>
<h3 id="django_filter">django_filter</h3>
<p>å®ç°å®šåˆ¶åŒ–çš„æŸ¥è¯¢åŠŸèƒ½ï¼Œå¯å¯¹ä¸åŒå­—æ®µè¿›è¡Œç²¾ç¡®å’Œæ¨¡ç³ŠæŸ¥è¯¢ã€‚</p>
<ol>
<li><a href="https://pypi.org/project/django-filter/">pypyå®˜ç½‘</a></li>
<li><a href="https://django-filter.readthedocs.io/en/master/guide/rest_framework.html">å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://www.jianshu.com/p/3a6ab28b3925">ç”¨django-filterå®ç°é«˜çº§æœç´¢</a></li>
</ol>
<h3 id="å¤–é”®-serializer">å¤–é”® serializer</h3>
<p>è‡ªåŠ¨åºåˆ—åŒ–å¤–é”®æ—¶ä¼šé‡åˆ°ä¸€äº›é—®é¢˜ã€‚<br>
<strong>å‚è€ƒæ–‡çŒ®</strong></p>
<ol>
<li><a href="https://stackoverflow.com/questions/28706072/drf-3-creating-many-to-many-update-create-serializer-with-though-table#">DRF 3 - Creating Many-to-Many update/create serializer with though table<br>
</a></li>
<li><a href="https://stackoverflow.com/questions/29950956/drf-simple-foreign-key-assignment-with-nested-serializers">DRF: Simple foreign key assignment with nested serializers?</a></li>
<li><a href="https://stackoverflow.com/questions/50015204/direct-assignment-to-the-forward-side-of-a-many-to-many-set-is-prohibited-use-e">manytomany ä¿å­˜æ–¹å¼</a></li>
</ol>
<pre><code class="language-python"># ç›´æ¥ä¿å­˜å¤šå¯¹å¤šå…³ç³»
    def create(self, validated_data):
        if validated_data.get('help_poor'):
            help_poor_datas = validated_data.pop('help_poor')
            activity_arrangement = ActivityArrangement.objects.create(**validated_data)

            for help_poor_data in help_poor_datas:
                help_poor = HelpPoor.objects.create(**help_poor_data)
                activity_arrangement.help_poor.add(help_poor)
        else:
            activity_arrangement = ActivityArrangement.objects.create(**validated_data)
        return activity_arrangement
</code></pre>
<h2 id="æ•°æ®åº“">æ•°æ®åº“</h2>
<h3 id="æ•°æ®åº“è¿æ¥">æ•°æ®åº“è¿æ¥</h3>
<h4 id="djangoè¿æ¥mongodbæ•°æ®åº“">djangoè¿æ¥mongodbæ•°æ®åº“</h4>
<p><strong>å‚è€ƒæ–‡çŒ®</strong></p>
<ol>
<li><a href="https://django-mongodb-engine.readthedocs.io/en/latest/topics/setup.html">Django MongoDB Engine</a></li>
<li><a href="https://docs.mongodb.com/manual/tutorial/install-mongodb-enterprise-on-os-x/">mongoæ•°æ®åº“å®˜æ–¹æ–‡æ¡£</a></li>
</ol>
<h4 id="model-migrate-é—®é¢˜">model migrate é—®é¢˜</h4>
<h5 id="django-migrate-error-table-xxx-already-exists">django migrate error: table 'xxx' already exists</h5>
<p>å¤šä¸ºç§»åº“åï¼Œåº“è¡¨ä¸migrationæ–‡ä»¶ä¸ç¬¦é€ æˆï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è§£å†³ã€‚</p>
<pre><code class="language-bash">python manage.py migrate --fake &lt;appname&gt;
</code></pre>
<p><strong>å‚è€ƒæ–‡çŒ®</strong></p>
<ol>
<li><a href="https://blog.csdn.net/zhiruchen/article/details/51243067">å‚è€ƒ</a></li>
<li><a href="http://stackoverflow.com/questions/25924858/django-1-7-migrate-gets-error-table-already-exists">stack over flow</a></li>
</ol>
<h3 id="æ•°æ®åº“è¿ç§»">æ•°æ®åº“è¿ç§»</h3>
<h4 id="slqlite3è¿ç§»mysql">slqlite3è¿ç§»mysql</h4>
<p>æ•°æ®åº“çš„è¿ç§»æ–¹æ³•é’ˆå¯¹ä¸åŒæ•°æ®åº“ï¼Œå¦‚ SQLite3, MySQL, PostgreSQL ä¹‹é—´æ•°æ®è¿ç§»æ–¹æ¡ˆï¼Œä»¥åŠæ•°æ®åœ¨ä¸åŒæœºå™¨ä¸Šè¿ç§»æ–¹æ¡ˆ</p>
<h5 id="ç®€å•çš„æ•°æ®å¯¼å‡ºä¸å¯¼å…¥ç®€å•çš„è¿ç§»">ç®€å•çš„æ•°æ®å¯¼å‡ºä¸å¯¼å…¥ï¼ˆç®€å•çš„è¿ç§»ï¼‰</h5>
<ol>
<li><code>django</code> é¡¹ç›®æä¾›äº†ä¸€ä¸ªå¯¼å‡ºçš„æ–¹æ³• <code>python manage.py dumpdata</code>, ä¸æŒ‡å®š <code>appname</code>æ—¶é»˜è®¤ä¸ºå¯¼å‡ºæ‰€æœ‰çš„app</li>
</ol>
<pre><code class="language-bash">python manage.py dumpdata [appname] &gt; appname_data.json
</code></pre>
<p>æ¯”å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªé¡¹ç›®å«<code>mysite</code>, é‡Œé¢æœ‰ä¸€ä¸ª<code>app</code>å«<code>blog</code>,æˆ‘ä»¬æƒ³å¯¼å‡º<code>blog</code>çš„æ‰€æœ‰æ•°æ®</p>
<pre><code class="language-bash">python manage.py dumpdata blog &gt; blog_dump.json
</code></pre>
<ol start="2">
<li>æ•°æ®å¯¼å…¥,ä¸éœ€è¦æŒ‡å®š<code>appname</code></li>
</ol>
<pre><code class="language-bash">python manage.py loaddata blog_dump.json
</code></pre>
<p><strong>! ! ! æ³¨æ„:</strong><br>
ä½¿ç”¨è¯¥æ–¹æ³•è§£å†³é—®é¢˜ï¼Œç¼ºå°‘è¡¨æ—¶æ‰‹åŠ¨æ·»åŠ åº“è¡¨<br>
å¤‡æ³¨ï¼šä¸€äº›å¸¸ç”¨çš„</p>
<pre><code class="language-bash">python manage.py dumpdata auth &gt; auth.json # å¯¼å‡ºç”¨æˆ·æ•°æ®
</code></pre>
<p>ä¼˜ç‚¹ï¼šå¯ä»¥å…¼å®¹å„ç§æ”¯æŒçš„æ•°æ®åº“ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä»¥å‰ç”¨çš„æ˜¯<code>SQLite3</code>ï¼Œå¯ä»¥å¯¼å‡ºåï¼Œç”¨è¿™ç§æ–¹æ³•å¯¼å…¥åˆ°<code>MySQL</code>, <code>PostgreSQL</code>ç­‰æ•°æ®åº“ï¼Œåè¿‡æ¥ä¹Ÿå¯ä»¥ã€‚<br>
ç¼ºç‚¹ï¼šæ•°æ®é‡å¤§çš„æ—¶å€™ï¼Œé€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢ï¼Œè¡¨çš„å…³ç³»æ¯”è¾ƒå¤æ‚çš„æ—¶å€™å¯ä»¥å¯¼å…¥ä¸æˆåŠŸã€‚</p>
<p>å¦‚æœä½ è¿æ°”å¥½çš„è¯å¯èƒ½ä¼šå¯¼å…¥å®Œæˆï¼Œä½†æ˜¯å¾€å¾€ä¸é‚£ä¹ˆé¡ºåˆ©ï¼ŒåŸå› å¦‚ä¸‹ï¼š<br>
a) æˆ‘ä»¬åœ¨å†™<code>models</code>çš„æ—¶å€™å¦‚æœç”¨åˆ°<code>CharField</code>,å°±ä¸€å®šè¦å†™<code>max_length</code>,åœ¨<code>sqlite3</code>ä¸­æ˜¯ä¸æ£€æŸ¥è¿™ä¸ªæœ€å¤§é•¿åº¦çš„ï¼Œä½ å†™æœ€å¤§å…è®¸é•¿åº¦ä¸º100ï¼Œä½ å¾€æ•°æ®åº“æ”¾10000ä¸ªï¼Œ<code>sqlite3</code>éƒ½ä¸æŠ¥é”™ï¼Œè€Œä¸”ä¸æˆªæ–­æ•°æ®çš„é•¿åº¦ï¼Œè¿™ä¼¼ä¹æ˜¯<code>slite3</code>çš„ä¼˜ç‚¹ï¼Œä½†æ˜¯ä¹Ÿç»™ä»<code>sqlite3</code>å¯¼å…¥å…¶å®ƒæ•°æ®åº“å¸¦æ¥äº†å›°éš¾,å› ä¸º<code>MySQL</code>å’Œ<code>PostgreSQL</code>æ•°æ®åº“éƒ½ä¼šæ£€æŸ¥æœ€å¤§é•¿åº¦ï¼Œè¶…å‡ºæ—¶å°±æŠ¥é”™ï¼</p>
<p>b) Django è‡ªå¸¦çš„contentTypeä¼šå¯¼è‡´å‡ºç°ä¸€äº›é—®é¢˜<br>
ç”¨ä¸Šé¢çš„æ–¹æ³•åªè¿ç§»ä¸€ä¸ªappåº”è¯¥é—®é¢˜ä¸å¤§ï¼Œä½†æ˜¯å¦‚æœæœ‰ç”¨æˆ·ï¼Œç”¨æˆ·ç»„æŒ‚é’©ï¼Œäº‹æƒ…å¾€å¾€å˜å¾—ç³Ÿç³•ï¼å¦‚æœå¯¼å…¥åæ²¡æœ‰å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œä½ å¯ä»¥è€ƒè™‘é‡æ–°å¯¼å…¥ï¼Œå¯èƒ½è¿˜è¦å¿«ä¸€äº›ï¼Œå¦‚æœæ˜¯æ‰‹åŠ¨åœ¨åå°è¾“å…¥æˆ–è€…ä¿®æ”¹è¿‡ï¼Œè¿™ç§æ–¹æ³•å°±ä¸é€‚ç”¨äº†<br>
<strong>å‚è€ƒæ–‡çŒ®</strong><br>
<a href="https://code.ziqiangxuetang.com/django/django-data-migration.html">è‡ªå¼ºå­¦å ‚</a></p>
<h5 id="é—®é¢˜">é—®é¢˜</h5>
<ol>
<li>Django 2.0 SQLite3 to MySQL loaddata error: â€œThe database backend does not accept 0 as a value for AutoField.â€</li>
</ol>
<pre><code class="language-json">//For illustration in datadump_3-7-18.json:
[
    {                                 //&lt;----- I GOT DELETED  
        &quot;model&quot;: &quot;inventory.bike&quot;,    //&lt;----- I GOT DELETED  
        &quot;pk&quot;: 0,                      //&lt;----- I GOT DELETED  
        &quot;fields&quot;: {                   //&lt;----- I GOT DELETED   
           //...                      //&lt;----- I GOT DELETED  
        }                             //&lt;----- I GOT DELETED  
    },                                //&lt;----- I GOT DELETED  
    {
        &quot;model&quot;: &quot;inventory.bike&quot;,
        &quot;pk&quot;: 1,
        &quot;fields&quot;: {
           //...
        }
    },
    {
        &quot;model&quot;: &quot;inventory.bike&quot;,
        &quot;pk&quot;: 2,
        &quot;fields&quot;: {
           //...
        }
    }
]
</code></pre>
<p><a href="https://stackoverflow.com/questions/49164472/django-2-0-sqlite3-to-mysql-loaddata-error-the-database-backend-does-not-accep">stackoverflow</a></p>
<h2 id="ä»viewåˆ°viewset">ä»viewåˆ°viewset</h2>
<p>djangoä½¿ç”¨Viewï¼Œ</p>
<ol>
<li><a href="https://www.jianshu.com/p/2700ff413250">django-rest-framework(æ¦‚å¿µç¯‡)â€”â€”apiview&amp;viewset</a></li>
</ol>
<h4 id="åˆ†é¡µ">åˆ†é¡µ</h4>
<p>åœ¨drfä¸­å¯¹äºæ•°æ®çš„è¿”å›æ”¯æŒå¤šç§åˆ†é¡µæŠ€å·§ï¼Œåœ¨å®˜ç½‘ä¸­ä¸»è¦å‘æˆ‘ä»¬ä»‹ç»äº†PageNumberPaginationã€LimitOffsetPaginationã€CursorPaginationã€‚</p>
<ol>
<li>é…ç½®å…¨å±€åˆ†é¡µ<br>
é‡‡ç”¨å…¨å±€é…ç½®éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®ï¼Œä¾‹å¦‚å°†å…¨å±€åˆ†é¡µè®¾ç½®ä¸ºPageNumberPaginationï¼Œéœ€è¦åœ¨base.pyä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</li>
</ol>
<pre><code class="language-python">REST_FRAMEWORK = {
    'DEFAULT_PAGINATION_CLASS': 'rest_framework.pagination.PageNumberPagination',
    'PAGE_SIZE': 100
}
</code></pre>
<ol start="2">
<li>å•ç‹¬è®¾ç½®åˆ†é¡µ<br>
å¦‚æœéœ€è¦å¯¹æ¯ä¸ªè§†å›¾è¿›è¡Œå•ç‹¬é…ç½®ï¼Œéœ€è¦è®¾ç½®ModelViewSetä¸­çš„pagination_classå€¼ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</li>
</ol>
<pre><code class="language-python">class MachineRoomViewSet(viewsets.ModelViewSet):
    &quot;&quot;&quot;
    æœºæˆ¿æ“ä½œè§†å›¾
    &quot;&quot;&quot;
    queryset = MachineRoom.objects.all()
    serializer_class = MachineRoomSerializer
    pagination_class = PageNumberPagination
</code></pre>
<ol start="3">
<li>ä¿®æ”¹åˆ†é¡µé£æ ¼<br>
å¦‚æœä½ éœ€è¦ä¿®æ”¹åˆ†é¡µé£æ ¼ ï¼Œç³»éœ€è¦é‡å†™åˆ†é¡µç±»ï¼Œç„¶åè®¾ç½®ä½ éœ€è¦ä¿®æ”¹çš„å±æ€§ã€‚</li>
</ol>
<pre><code class="language-python">class LargeResultsSetPagination(PageNumberPagination):
    page_size = 1000
    page_size_query_param = 'page_size'
    max_page_size = 10000

class StandardResultsSetPagination(PageNumberPagination):
    page_size = 100
    page_size_query_param = 'page_size'
    max_page_size = 1000

# ç„¶ååœ¨è§†å›¾ä¸­ä½¿ç”¨.pagination_classå±æ€§è°ƒç”¨è¯¥è‡ªå®šä¹‰ç±»
class BillingRecordsView(generics.ListAPIView):
    queryset = Billing.objects.all()
    serializer_class = BillingRecordsSerializer
    pagination_class = LargeResultsSetPagination

# æˆ–è€…æ˜¯åœ¨è®¾ç½®ä¸­ä¿®æ”¹DEFAULT_PAGINATION_CLASS
REST_FRAMEWORK = {
    'DEFAULT_PAGINATION_CLASS': 'apps.core.pagination.StandardResultsSetPagination'
}
</code></pre>
<ol start="5">
<li>pageNumberPaginationä½¿ç”¨æ–¹æ³•<br>
è¿™ä¸ªåˆ†é¡µæ ·å¼æ¥å—è¯·æ±‚æŸ¥è¯¢å‚æ•°ä¸­çš„ä¸€ä¸ªæ•°å­—é¡µé¢å·ã€‚</li>
</ol>
<pre><code>GET https://api.example.org/accounts/?page=4
</code></pre>
<p>å“åº”å¯¹è±¡</p>
<pre><code>HTTP 200 OK
{
    &quot;count&quot;: 1023
    &quot;next&quot;: &quot;https://api.example.org/accounts/?page=5&quot;,
    &quot;previous&quot;: &quot;https://api.example.org/accounts/?page=3&quot;,
    &quot;results&quot;: [
       â€¦
    ]
}
</code></pre>
<p><a href="https://blog.csdn.net/runnoob_1115/article/details/78506659">Django-restframework Paginationï¼ˆåˆ†é¡µï¼‰</a></p>
<p><a href="https://www.django-rest-framework.org/api-guide/pagination/">Django-rest-framework pagination</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Hello Gridea]]></title>
        <id>https://harveywxia.github.io/post/hello-gridea/</id>
        <link href="https://harveywxia.github.io/post/hello-gridea/">
        </link>
        <updated>2018-12-11T16:00:00.000Z</updated>
        <summary type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
]]></summary>
        <content type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
<!-- more -->
<p><a href="https://github.com/getgridea/gridea">Github</a><br>
<a href="https://gridea.dev/">Gridea ä¸»é¡µ</a><br>
<a href="http://fehey.com/">ç¤ºä¾‹ç½‘ç«™</a></p>
<h2 id="ç‰¹æ€§">ç‰¹æ€§ğŸ‘‡</h2>
<p>ğŸ“  ä½ å¯ä»¥ä½¿ç”¨æœ€é…·çš„ <strong>Markdown</strong> è¯­æ³•ï¼Œè¿›è¡Œå¿«é€Ÿåˆ›ä½œ</p>
<p>ğŸŒ‰  ä½ å¯ä»¥ç»™æ–‡ç« é…ä¸Šç²¾ç¾çš„å°é¢å›¾å’Œåœ¨æ–‡ç« ä»»æ„ä½ç½®æ’å…¥å›¾ç‰‡</p>
<p>ğŸ·ï¸  ä½ å¯ä»¥å¯¹æ–‡ç« è¿›è¡Œæ ‡ç­¾åˆ†ç»„</p>
<p>ğŸ“‹  ä½ å¯ä»¥è‡ªå®šä¹‰èœå•ï¼Œç”šè‡³å¯ä»¥åˆ›å»ºå¤–éƒ¨é“¾æ¥èœå•</p>
<p>ğŸ’»  ä½ å¯ä»¥åœ¨ <strong>Windows</strong>ï¼Œ<strong>MacOS</strong> æˆ– <strong>Linux</strong> è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å®¢æˆ·ç«¯</p>
<p>ğŸŒ  ä½ å¯ä»¥ä½¿ç”¨ <strong>ğ–¦ğ—‚ğ—ğ—ğ—ğ–» ğ–¯ğ–ºğ—€ğ–¾ğ—Œ</strong> æˆ– <strong>Coding Pages</strong> å‘ä¸–ç•Œå±•ç¤ºï¼Œæœªæ¥å°†æ”¯æŒæ›´å¤šå¹³å°</p>
<p>ğŸ’¬  ä½ å¯ä»¥è¿›è¡Œç®€å•çš„é…ç½®ï¼Œæ¥å…¥ <a href="https://github.com/gitalk/gitalk">Gitalk</a> æˆ– <a href="https://github.com/SukkaW/DisqusJS">DisqusJS</a> è¯„è®ºç³»ç»Ÿ</p>
<p>ğŸ‡¬ğŸ‡§  ä½ å¯ä»¥ä½¿ç”¨<strong>ä¸­æ–‡ç®€ä½“</strong>æˆ–<strong>è‹±è¯­</strong></p>
<p>ğŸŒ  ä½ å¯ä»¥ä»»æ„ä½¿ç”¨åº”ç”¨å†…é»˜è®¤ä¸»é¢˜æˆ–ä»»æ„ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œå¼ºå¤§çš„ä¸»é¢˜è‡ªå®šä¹‰èƒ½åŠ›</p>
<p>ğŸ–¥  ä½ å¯ä»¥è‡ªå®šä¹‰æºæ–‡ä»¶å¤¹ï¼Œåˆ©ç”¨ OneDriveã€ç™¾åº¦ç½‘ç›˜ã€iCloudã€Dropbox ç­‰è¿›è¡Œå¤šè®¾å¤‡åŒæ­¥</p>
<p>ğŸŒ± å½“ç„¶ <strong>Gridea</strong> è¿˜å¾ˆå¹´è½»ï¼Œæœ‰å¾ˆå¤šä¸è¶³ï¼Œä½†è¯·ç›¸ä¿¡ï¼Œå®ƒä¼šä¸åœå‘å‰ ğŸƒ</p>
<p>æœªæ¥ï¼Œå®ƒä¸€å®šä¼šæˆä¸ºä½ ç¦»ä¸å¼€çš„ä¼™ä¼´</p>
<p>å°½æƒ…å‘æŒ¥ä½ çš„æ‰åå§ï¼</p>
<p>ğŸ˜˜ Enjoy~</p>
]]></content>
    </entry>
</feed>