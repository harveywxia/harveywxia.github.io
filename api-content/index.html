{"posts":[{"title":"Githubæ­å»ºä¸ªäººä¸»é¡µ","content":"æ¦‚è¿° GitHub Pageså¯ä»¥ç”¨æ¥æ‰˜ç®¡ä¸ªäººé™æ€ç½‘ç«™ï¼Œä¾¿äºç”¨æ¥å®ç°åšå®¢ã€‚ å‡†å¤‡å·¥ä½œ Gthubè´¦å· åŸŸå(å¯é€‰) Github Pages æ–°å»ºä¸€ä¸ªä»“åº“ï¼Œå‘½åæ ¼å¼å¦‚ä¸‹ï¼š {ç”¨æˆ·æ˜}.github.io éœ€è¦é€‰æ‹©publicï¼ˆå…¬å¼€ï¼‰ è¿›å…¥åˆ°è¯¥ä»“åº“çš„settingèœå•ï¼ˆåœ¨starä¸‹é¢ï¼‰ä¸­ã€‚å¯ä»¥é€‰æ‹©å¹¶å¼€å¯ã€‚ æ­¤æ—¶åœ¨æµè§ˆå™¨ä¸­å³å¯è®¿é—®é¡µé¢ï¼Œä½†æ˜¯å¦‚æœæƒ³æ›´å¥½çš„ç®¡ç†ï¼Œå¯ä»¥ä½¿ç”¨Grideaã€‚ Gridea Grideaæ˜¯ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨æœ¬åœ°ï¼Œæ²¡æœ‰æ•°æ®åº“ï¼Œå®ç°ç®€å•ï¼Œæ”¯æŒMarkdownã€‚ å®˜ç½‘ä¸‹è½½Grideaï¼Œå®‰è£…å¹¶è¿›å…¥è®¾ç½®é¡µé¢ åŸŸåä¸ä»“åº“åä¸€æ ·,åˆ†æ”¯å¡«master,emailè‡ªå·±å¡«,è¿™é‡Œè¯´ä¸€ä¸‹Token.æ‰“å¼€è®¾ç½®ä¸­çš„å¼€å‘è€…è®¾ç½®: å³ä¸Šè§’å¤´åƒ--&gt;Settings --&gt;Developer settings --&gt;Personal access tokens--&gt;Generate token å‹¾é€‰repoç„¶åå¤åˆ¶tokenå³å¯ã€‚ å‚è€ƒèµ„æ–™ Github Pages+Grideaæ­å»ºä¸ªäººåšå®¢ ã€ŒGrideaã€ç»™åˆæ¥è§¦è€…çš„ä¸€äº›ä½¿ç”¨æŠ€å·§ ","link":"https://harveywxia.github.io/post/github-da-jian-ge-ren-zhu-ye/"},{"title":"Redmineé…ç½®","content":"é—®é¢˜çŠ¶æ€ é—®é¢˜çŠ¶æ€æ ‡ç­¾ï¼šæ–°å»ºé—®é¢˜ã€æ–°å»ºã€è¿›è¡Œä¸­ã€å·²è§£å†³ã€åé¦ˆã€å·²å…³é—­ã€å·²æ‹’ç»ã€æŒ‚èµ·ã€‚ redmineæ·»åŠ è‡ªå®šä¹‰é—®é¢˜çŠ¶æ€ è·Ÿè¸ªæ ‡ç­¾ è·Ÿè¸ªæ ‡ç­¾ï¼šé‡Œç¨‹ç¢‘ã€ä»»åŠ¡ã€éœ€æ±‚ç”¨ä¾‹ã€åŠŸèƒ½ã€ç¼ºé™· é¡¹ç›®ä¸­å„è·Ÿè¸ªæ ‡ç­¾çš„ç»“æ„å…³ç³» è¯´æ˜ï¼š 1ï¼ 5ä¸ªé‡Œç¨‹ç¢‘ï¼šéœ€æ±‚åˆ†æã€æ¦‚è¦è®¾è®¡ã€åŠŸèƒ½å¼€å‘ã€ç³»ç»Ÿæµ‹è¯•ã€ç³»ç»Ÿéƒ¨ç½² 2ï¼ åœ¨â€œéœ€æ±‚åˆ†æâ€ã€â€œæ¦‚è¦è®¾è®¡â€ã€â€œç³»ç»Ÿæµ‹è¯•â€ã€â€œéƒ¨ç½²ä¸Šçº¿â€ è¿™å‡ ä¸ªé‡Œç¨‹ç¢‘ä¸­ä¸»è¦æ˜¯ä»¥â€œä»»åŠ¡â€çš„å½¢å¼æŒ‡æ´¾ç»™é¡¹ç›®æˆå‘˜ 3ï¼ â€œåŠŸèƒ½å¼€å‘â€è¿™ä¸ªé‡Œç¨‹ç¢‘ä¸­æœ‰æ¶‰åŠåˆ°â€œéœ€æ±‚ç”¨ä¾‹â€â€œåŠŸèƒ½â€â€œä»»åŠ¡â€â€œç¼ºé™·â€ 4. è‹¥åŠŸèƒ½åˆ’åˆ†çš„ä¸å¤Ÿç»†ï¼Œåˆ™å¯å°†å…¶ä»¥ä»»åŠ¡çš„å½¢å¼å†æ¬¡åˆ’åˆ†ã€‚ ","link":"https://harveywxia.github.io/post/redmine-pei-zhi/"},{"title":"CentOS7å®‰è£…redmine","content":"ç®€ä»‹ Redmineæ˜¯ç”¨Rubyå¼€å‘çš„åŸºäºwebçš„é¡¹ç›®ç®¡ç†è½¯ä»¶ï¼Œæ˜¯ç”¨RORæ¡†æ¶å¼€å‘çš„ä¸€å¥—è·¨å¹³å°é¡¹ç›®ç®¡ç†ç³»ç»Ÿï¼Œé€šè¿‡â€œé¡¹ç›®ï¼ˆProjectï¼‰â€çš„å½¢å¼æŠŠæˆå‘˜ã€ä»»åŠ¡ï¼ˆé—®é¢˜ï¼‰ã€æ–‡æ¡£ã€è®¨è®ºä»¥åŠå„ç§å½¢å¼çš„èµ„æºç»„ç»‡åœ¨ä¸€èµ·ï¼Œå¤§å®¶å‚ä¸æ›´æ–°ä»»åŠ¡ã€æ–‡æ¡£ç­‰å†…å®¹æ¥æ¨åŠ¨é¡¹ç›®çš„è¿›åº¦ï¼ŒåŒæ—¶ç³»ç»Ÿåˆ©ç”¨æ—¶é—´çº¿ç´¢å’Œå„ç§åŠ¨æ€çš„æŠ¥è¡¨å½¢å¼æ¥è‡ªåŠ¨ç»™æˆå‘˜æ±‡æŠ¥é¡¹ç›®è¿›åº¦ã€‚ å®‰è£…æµç¨‹ dockerç¯å¢ƒå®‰è£… å¸è½½æ—§ç‰ˆæœ¬ è¾ƒæ—§çš„ Docker ç‰ˆæœ¬ç§°ä¸º docker æˆ– docker-engine ã€‚å¦‚æœå·²å®‰è£…è¿™äº›ç¨‹åºï¼Œè¯·å¸è½½å®ƒä»¬ä»¥åŠç›¸å…³çš„ä¾èµ–é¡¹ã€‚ $ sudo yum remove docker \\ docker-client \\ docker-client-latest \\ docker-common \\ docker-latest \\ docker-latest-logrotate \\ docker-logrotate \\ docker-engine å®‰è£…docker ä¾èµ–ç¯å¢ƒ yum-utils æä¾›äº† yum-config-manager ï¼Œå¹¶ä¸” device mapper å­˜å‚¨é©±åŠ¨ç¨‹åºéœ€è¦ device-mapper-persistent-data å’Œ lvm2ã€‚ $ sudo yum install -y yum-utils \\ device-mapper-persistent-data \\ lvm2 å®‰è£… Docker Engine-Community å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Docker Engine-Community å’Œ containerd. $ sudo yum install docker-ce docker-ce-cli containerd.io å¯åŠ¨ Docker $ sudo systemctl start docker æµ‹è¯• é€šè¿‡è¿è¡Œ hello-world æ˜ åƒæ¥éªŒè¯æ˜¯å¦æ­£ç¡®å®‰è£…äº† Docker Engine-Community ã€‚ $ sudo docker run hello-world è¿è¡Œä»¥ä¸Šå‘½ä»¤ä¼šæ‰“å°å‡ºhello-worldã€‚ å®‰è£…docker-compose è¿™é‡Œé€‰æ‹©ä½¿ç”¨pipå®‰è£…ï¼Œpipçš„å®‰è£…è¿‡ç¨‹è¿™é‡Œä¸å±•å¼€ã€‚ ä½¿ç”¨pipå®‰è£…æ—¶å»ºè®®ä½¿ç”¨virtulenvï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼š pip install docker-compose å¦‚æœä½ ä¸ä½¿ç”¨virtulenvï¼Œåˆ™éœ€è¦è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå®Œæˆå®‰è£…ã€‚ sudo pip install docker-compose æµ‹è¯• docker-compose -version ä¼šæ‰“å°å‡ºç›¸å…³ç‰ˆæœ¬ä¿¡æ¯ã€‚ å‚è€ƒ Install Docker Compose å®‰è£…redmine version: '3' services: redmine: image: redmine:4.1.1-alpine restart: always ports: - '8080:3000' environment: REDMINE_DB_MYSQL: mysql REDMINE_DB_PASSWORD: redminemysql REDMINE_SECRET_KEY_BASE: supersecretkey volumes: - '/usr/harvey/docker/redmine/redmine_dir:/usr/src/redmine/files' mysql: image: mysql:8.0.20 restart: always environment: MYSQL_ROOT_PASSWORD: redminemysql MYSQL_DATABASE: redmine volumes: - '/usr/harvey/docker/redmine/mysql__dir:/var/lib/mysql' å‚è€ƒ dockerhub-redmine æµ‹è¯• æµè§ˆå™¨ä¸­è¾“å…¥ä»¥ä¸‹ç½‘å€ï¼Œ http://localhost:8080/login è¿›å…¥ç™»å½•ç•Œé¢ï¼Œé»˜è®¤ç”¨æˆ·å/å¯†ç ï¼šadmin/admin å¼€å§‹ä½ çš„redmineä¹‹æ—…å§ã€‚ ","link":"https://harveywxia.github.io/post/centos7-an-zhuang-redmine/"},{"title":"Django rest framework ä½¿ç”¨ç¬”è®°  ","content":"modelså±‚ models field åœ¨modelä¸­æ·»åŠ å­—æ®µçš„æ ¼å¼ä¸€èˆ¬ä¸ºï¼š field_name = field_type(**field_options) field options(æ‰€æœ‰å­—æ®µå…±ç”¨) null é»˜è®¤ä¸ºFalseï¼ŒTrueåˆ™è¡¨ç¤ºå¯ä»¥ä¸ºnullã€‚ï¼ˆç©ºå­—ç¬¦ä¸²åœ¨æ•°æ®åº“ä¸­å¯èƒ½è¢«å­˜å‚¨ä¸º''ï¼‰ blank é»˜è®¤ä¸ºFalseï¼ŒTrueè¡¨ç¤ºå¯ä»¥ä¸ºç©ºã€‚ choice å¯é€‰çš„ï¼Œé™åˆ¶äº†è¯¥é€‰é¡¹çš„å­—æ®µå€¼å¿…é¡»æ˜¯æ‰€æŒ‡å®šçš„choiceä¸­çš„ä¸€ä¸ªã€‚ from django.db import models class Student(models.Model): FRESHMAN = 'FR' SOPHOMORE = 'SO' JUNIOR = 'JR' SENIOR = 'SR' YEAR_IN_SCHOOL_CHOICES = ( (FRESHMAN, 'Freshman'), #ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯çœŸæ­£çš„modelå‚æ•°ï¼Œ#ç¬¬äºŒä¸ªå‚æ•°åˆ™æ˜¯æ–¹ä¾¿äººä»¬ç†è§£é˜…è¯» (SOPHOMORE, 'Sophomore'), (JUNIOR, 'Junior'), (SENIOR, 'Senior'), ) year_in_school = models.CharField( max_length=2, choices=YEAR_IN_SCHOOL_CHOICES, default=FRESHMAN, ) def is_upperclass(self): return self.year_in_school in (self.JUNIOR, self.SENIOR) db_column: æ•°æ®åº“columnåç§°ã€‚é»˜è®¤ä¸ºæœ¬å­—æ®µçš„åç§°; db_index: å¦‚æœä¸ºTrueçš„è¯ï¼Œè¯¥å­—æ®µçš„æ•°æ®åº“ç´¢å¼•å°†ä¼šè¢«åˆ›å»º; default: è®¾ç½®è¯¥å­—æ®µçš„é»˜è®¤å€¼ï¼Œå¯ä»¥æ˜¯å€¼ä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡; editable: é»˜è®¤ä¸ºTrueï¼Œè‹¥ä¸ºFalseï¼Œåˆ™ä¸ä¼šåœ¨adminç•Œé¢æ˜¾ç¤º; primary_key: è‹¥è®¾ç½®ä¸ºTrueï¼Œåˆ™è¡¨ç¤ºå°†è¯¥å­—æ®µè®¾ç½®ä¸ºä¸»é”®ã€‚ä¸€èˆ¬æƒ…å†µä¸‹djangoé»˜è®¤ä¼šè®¾ç½®ä¸€ä¸ªè‡ªå¢é•¿çš„idä¸»é”®; unique: è‹¥è®¾ç½®ä¸ºTrueï¼Œè¯¥å­—æ®µå€¼ä¸å¯é‡å¤. field type(å­—æ®µç±»å‹) modelsåŸºç¡€å­—æ®µ AutoField() æ ¹æ®å·²æœ‰idè‡ªå¢é•¿çš„æ•´å½¢å”¯ä¸€å­—æ®µï¼Œä¸€èˆ¬æ¯ä¸ªmodelç±»ä¸éœ€è®¾ç½®è¯¥å­—æ®µï¼Œå› ä¸ºdjangoä¼šä¸ºæ¯ä¸ªmodelè‡ªåŠ¨è®¾ç½®ã€‚ djangoé»˜è®¤ä¼šä¸ºæ¯ä¸ªmodelç±»æ·»åŠ å¦‚ä¸‹è¯­å¥ï¼š id = models.AutoField(primary_key=True) å½“å…¶ä»–å­—æ®µæ·»åŠ äº†primary_keyå±æ€§ï¼Œåˆ™ä¸ä¼šåˆ›å»ºidå­—æ®µäº†,æ¯ä¸ªmodelç±»ä»…èƒ½æœ‰ä¸€ä¸ªä¸»é”®. BooleanField() å¸ƒå°”å‹å­—æ®µï¼Œé»˜è®¤çš„è¡¨å•çª—å£éƒ¨ä»¶æ˜¯CheckBoxInput CharField() å­—ç¬¦å‹å­—æ®µï¼Œé»˜è®¤çš„è¡¨å•çª—å£éƒ¨ä»¶æ˜¯TextInputã€‚è¯¥å­—æ®µç±»å‹æœ‰ä¸€ä¸ªå¿…éœ€å‚æ•°ï¼š max_length åœ¨æ•°æ®åº“æ°´å¹³é™å®šäº†å­—ç¬¦ä¸²æœ€å¤§é•¿åº¦ DateField() æ—¥æœŸå­—æ®µï¼Œå­—æ®µçš„å€¼æ˜¯pythonä¸­datetime.dateçš„å®ä¾‹ï¼Œé»˜è®¤çš„è¡¨å•çª—å£æ˜¯TextInputæœ‰å‡ ä¸ªå¯é€‰çš„å‚æ•°ï¼š auto_now=True/False: å½“è®¾ç½®ä¸ºTrueæ—¶ï¼Œæ¯å½“è¯¥å¯¹è±¡ä½¿ç”¨save()æ—¶ï¼Œè¯¥å­—æ®µçš„å€¼å°±ä¼šè¢«æ›´æ–°ã€‚ auto_now_add=True/False: å½“è®¾ç½®ä¸ºTrueæ—¶ï¼Œè¯¥å­—æ®µçš„å€¼ä¸ºè¯¥å¯¹è±¡è¢«åˆ›å»ºæ—¶çš„æ—¥æœŸ DateTimeField() æ—¥æœŸå’Œæ—¶é—´å­—æ®µï¼Œå€¼ä¸ºdatetime.datetimeå®ä¾‹ã€‚é»˜è®¤çš„è¡¨å•çª—å£ä»¥åŠå¯é€‰å‚æ•°åŒä¸Šã€‚ DecimalField() æ··åˆç²¾åº¦çš„å°æ•°å‹æ•°å­—å­—æ®µã€‚æœ‰ä¸¤ä¸ªå¿…éœ€çš„å‚æ•°ï¼š max_digits=ingt_number:é™å®šæ•°å­—çš„æœ€å¤§ä½æ•°ï¼ˆåŒ…å«å°æ•°ä½ï¼‰ decimal_places=int_number:å­˜å‚¨æ•°å­—çš„å°æ•°ä½ #to store numbers up to 999 with a resolution of 2 decimal places, youâ€™d use models.DecimalField(..., max_digits=5, decimal_places=2) EmailField(max_length=254, **options) é‚®ä»¶å­—æ®µï¼Œä½¿ç”¨EmailValidatorè¿›è¡ŒéªŒè¯ FileField(upload_to=None, max_length=100, **options) æ–‡ä»¶ä¸Šä¼ å­—æ®µã€‚è¿™ä¸ªå­—æ®µä¸èƒ½è®¾ç½®primary_keyå’Œuniqueé€‰é¡¹.åœ¨æ•°æ®åº“ä¸­å­˜å‚¨ç±»å‹æ˜¯varcharï¼Œé»˜è®¤æœ€å¤§é•¿åº¦ä¸º100. æœ‰ä¸¤ä¸ªå¯é€‰å‚æ•°ï¼š upload_to: å¦‚æœä½¿ç”¨é»˜è®¤çš„FileSystomStorageï¼Œæ–‡ä»¶å°†ä¼šå­˜å‚¨åˆ°settingsæ–‡ä»¶ä¸­é…ç½®çš„MEDIA_ROOTè·¯å¾„ä¸­ã€‚upload_toçš„å€¼ä¹Ÿå¯ä»¥ä¸ºå¯è°ƒç”¨å¯¹è±¡,é€šè¿‡è°ƒç”¨è¿™ä¸ªå¯¹è±¡å¯ä»¥è·å¾—ä¸Šä¼ è·¯å¾„ã€‚ instance=: å®šä¹‰äº†FileFieldçš„æ¨¡å‹å®ä¾‹ filename='': æ–‡ä»¶åç§°ã€‚ class MyModel01(models.Model): # file will be uploaded to MEDIA_ROOT/uploads upload = models.FileField(upload_to='uploads/') # or... # file will be saved to MEDIA_ROOT/uploads/2015/01/30 upload = models.FileField(upload_to='uploads/%Y/%m/%d/') #upload_to=å¯è°ƒç”¨å¯¹è±¡ def user_directory_path(instance, filename): # file will be uploaded to MEDIA_ROOT/user_&lt;id&gt;/&lt;filename&gt; return 'user_{0}/{1}'.format(instance.user.id, filename) class MyModel02(models.Model): upload = models.FileField(upload_to=user_directory_path) storage ç”¨æ¥è®¾å®šæ–‡ä»¶å­˜å‚¨ä»“åº“ FilePathField(path=None, match=None, recursive=False, max_length=100, **options) è¿™ä¸ªå­—æ®µçš„å€¼è¢«é™åˆ¶åœ¨ç³»ç»Ÿä¸ŠæŸä¸ªç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶åé›†åˆä¸­ã€‚æœ‰ä¸‰ä¸ªå‚æ•°: path='': è¯¥å‚æ•°å¿…éœ€ã€‚ä¸Šè¡Œæ‰€è¯´çš„'æŸä¸ªç›®å½•â€™çš„ç»å¯¹è·¯å¾„ã€‚Example: &quot;/home/images&quot;. match='pattern': å¯é€‰å‚æ•°ã€‚æ ¼å¼æ˜¯æ­£åˆ™è¡¨è¾¾å¼ã€‚ç”¨æ¥æ‹£é€‰ç¬¦åˆåŒ¹é…æ­£åˆ™è¡¨è¾¾å¼çš„æ–‡ä»¶ recursive=True/False: å¯é€‰å‚æ•°ï¼Œé»˜è®¤ä¸ºFalseã€‚è®¾å®šæ˜¯å¦é€’å½’è¯¥ç›®å½•ä¸‹æ‰€æœ‰å­ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶ã€‚ FilePathField(path=&quot;/home/images&quot;, match=&quot;foo.*&quot;, recursive=True) FloatField() æµ®ç‚¹å­—æ®µï¼Œé»˜è®¤çš„è¡¨å•çª—å£éƒ¨ä»¶æ˜¯NumberInputã€‚å’ŒDecimalFieldç»å¸¸æ··æ·†ä¸æ¸…ï¼ŒFloatFieldåœ¨å†…éƒ¨ä½¿ç”¨Pythonä¸­çš„floatå¯¹è±¡ï¼Œè€ŒDecimalFieldåœ¨å†…éƒ¨ä½¿ç”¨Pythonä¸­çš„decimalå¯¹è±¡ã€‚ ImageField(upload_to=None, height_field=None, width_field=None, max_length=100, **options) å›¾åƒå­—æ®µã€‚ç»§æ‰¿äº†FileFieldçš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ã€‚è€Œä¸”è¿˜èƒ½è‡ªåŠ¨éªŒè¯ä¸Šä¼ çš„å¯¹è±¡æ˜¯å¦ä¸ºåˆæ³•çš„å›¾åƒã€‚ IntegerField() æ•´å‹å­—æ®µã€‚ GenericIPAddressField(protocol='both', unpack_ipv4=False, **options) ipåœ°å€å­—æ®µ protocol='both/ipv4/ipv6': é»˜è®¤ä¸ºboth unpack_ipv4: ç”¨å¤„ä¸å¤§ã€‚ NullBooleanField() ç±»ä¼¼äºBooleanFieldï¼Œä¸åŒçš„æ˜¯å…¶å…è®¸å€¼ä¸ºnull TextField() ä¸CharFieldç±»ä¼¼ï¼Œä½†ä¸€èˆ¬ç”¨æ¥å­˜å‚¨ä½“ç§¯è¾ƒå¤§çš„æ–‡æœ¬ã€‚ TimeField(auto_now=False, auto_now_add=False, **options)` æ—¶é—´å­—æ®µï¼Œå…¶å€¼ä¸ºdatetime.timeå®ä¾‹ URLField(max_length=200, **options)URLå­—æ®µ, ç±»ä¼¼äºCharField`çš„å­ç±»ï¼Œé»˜è®¤æœ€å¤§é•¿åº¦ä¸º200. UUIDField(**options)é€šç”¨å”¯ä¸€æ ‡è¯†å­—æ®µï¼Œå½“ä¸æƒ³ç”¨djangoé»˜è®¤è®¾ç½®çš„AutoField`å­—æ®µæ—¶ï¼Œå¯ä»¥ç”¨è¯¥å­—æ®µä»£æ›¿ã€‚ å…³ç³»å­—æ®µ 1. ä¸€å¯¹ä¸€ï¼š ç°åœ¨æœ‰å¾ˆå¤šä¸€å¯¹ä¸€è¾…å¯¼ç­ï¼Œä¹Ÿå°±æ˜¯ä¸Šè¯¾æ—¶ï¼Œä¸€ä¸ªè€å¸ˆå¯¹åº”ä¸€ä¸ªå­¦ç”Ÿï¼Œä¸€ä¸ªå­¦ç”Ÿå¯¹åº”ä¸€ä¸ªè€å¸ˆ 2. å¤šå¯¹ä¸€ï¼š å¾ˆå¤šåè¿œå±±åŒºçš„å­¦æ ¡å¯èƒ½æ•´ä¸ªå­¦æ ¡åªæœ‰ä¸€ä¸ªè€å¸ˆï¼Œè¿™ä¸€ä¸ªè€å¸ˆå¯¹åº”å¤šä¸ªå­¦ç”Ÿï¼Œæ‰€æœ‰çš„å­¦ç”Ÿå¯¹åº”è¿™ä¸€ä¸ªè€å¸ˆ 3. å¤šå¯¹å¤šï¼š è€Œæˆ‘ä»¬åˆ™å¾ˆå¹¸ç¦ï¼Œå­¦æ ¡é‡Œæœ‰è®¸å¤šè€å¸ˆï¼Œä¸€ä¸ªè€å¸ˆæ•™ä¹ ä¸€ç§‘ï¼Œå­¦ç”Ÿæœ‰å¤šä¸ªè€å¸ˆï¼Œè€å¸ˆæœ‰å¤šä¸ªå­¦ç”Ÿã€‚ ForeignKey(othermodel, on_delete, **options) ç”¨äºå¤šå¯¹ä¸€æˆ–è€…ä¸€å¯¹å¤šæˆ–è€…å¤–é”®å­—æ®µ: othermodelï¼š æ‰€å…³è”çš„æ¨¡å‹ï¼Œ'å¤š' modelä½¿ç”¨å¤–é”®å…³è” 'ä¸€'modelã€‚ å½“æ‰€å…³è”çš„æ¨¡å‹ä¸ºä»–è‡ªå·±æ—¶ï¼Œä½¿ç”¨'self'; å½“å¼•ç”¨çš„æ¨¡å‹ä¸ºå…¶ä»–appä¸­çš„æ¨¡å‹æ—¶ï¼Œè¦åŠ ä¸Šappåç§°æ ‡ç­¾: 'app_name.model_name'; æ•°æ®åº“ä¼šè‡ªåŠ¨åœ¨å¤–é”®å­—æ®µä¸Šåˆ›å»ºç´¢å¼•ï¼Œå¯ä»¥ä½¿ç”¨de_index=Falseå…³é—­è¯¥åŠŸèƒ½ã€‚ on_deleteï¼š å½“åˆ é™¤ &quot;ä¸€&quot; æ¨¡å‹å¯¹è±¡æ—¶ï¼Œdjangoä¼šæ ¹æ®è¯¥å‚æ•°çš„å€¼å¯¹ä¸è¯¥å¯¹è±¡ç›¸å…³è”çš„å…¶ä»–å¯¹è±¡(ä¹Ÿå°±æ˜¯ 'å¤šâ€™)è¿›è¡Œæ“ä½œã€‚ åœ¨django1.9ä»¥åŠä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œon_deleteä½œä¸ºä¸€ä¸ªå…³é”®å­—å‚æ•°ã€‚è€Œåœ¨1.10åˆ™å¯ä»¥ä½œä¸ºç¬¬äºŒä¸ªå‚æ•° models.CASCADEï¼š é»˜è®¤ä¸ºmodels.CASCADE çº§è”åˆ é™¤ã€‚å½“åˆ é™¤'ä¸€'æ—¶ï¼Œ'å¤šâ€™ä¼šè¢«åˆ é™¤ã€‚æ¯”å¦‚ï¼š # mysiteé¡¹ç›®ä¸‹åä¸ºpollsçš„appä¸­çš„models.py class follower(models.Model): name = models.CharField(max_length=200) menpai = models.ForeignKey('menpai', on_delete=models.CASCADE) #å®šä¹‰äº†models.CASCADEå±æ€§ def __str__(self): return self.name class menpai(models.Model): name = models.CharField(max_length=200) def __str__(self): return self.name #è¿è¡Œ python3 manager.py shellè¿›å…¥äº¤äº’é¡µé¢ &gt;&gt;&gt; from polls.models import follower,menpai &gt;&gt;&gt; m1=menpai(name='huashanpai') &gt;&gt;&gt; m1.save() &gt;&gt;&gt; m2=menpai(name='riyuejiao') &gt;&gt;&gt; m2.save() &gt;&gt;&gt; f1=follower(name='linghuchong',menpai=m1) &gt;&gt;&gt; f1.save() &gt;&gt;&gt; f2=follower(name='renwoxing',menpai=m2) &gt;&gt;&gt; f2.save() &gt;&gt;&gt; f1.menpai &lt;menpai: huashanpai&gt; &gt;&gt;&gt; m1.delete() (2, {'polls.menpai': 1, 'polls.follower': 1}) # åˆ é™¤åå±±æ´¾æ—¶ï¼Œå°†ä»¤ç‹å†²ä¹Ÿåˆ é™¤äº† modles.PROTECT : å½“åˆ é™¤ä¸€ä¸ªå…·æœ‰å¤–é”®å…³ç³»çš„å¯¹è±¡æ—¶ï¼Œä¼šå¼•å‘ä¸€ä¸ªå¼‚å¸¸ï¼Œé˜»æ­¢åˆ é™¤è¯¥å¯¹è±¡ models.SET_NULL: è®¾ç½®åˆ é™¤å¯¹è±¡æ‰€å…³è”çš„å¤–é”®å­—æ®µä¸ºnullã€‚ä½†å­—æ®µçš„nullå±æ€§å¿…éœ€ä¸ºTrue models.SET_DEFAULT : è®¾ç½®åˆ é™¤å¯¹è±¡æ‰€å…³è”çš„å¤–é”®å­—æ®µä¸ºé»˜è®¤çš„å€¼ã€‚ models.SET(value)ï¼šè®¾ç½®åˆ é™¤å¯¹è±¡æ‰€å…³è”çš„å¯¹è±¡çš„å¤–é”®å­—æ®µä¸ºvalue,valueä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå¯è°ƒç”¨å‡½æ•°ã€‚ from django.conf import settings from django.contrib.auth import get_user_model from django.db import models def get_sentinel_user(): return get_user_model().objects.get_or_create(username='deleted')[0] class MyModel(models.Model): user = models.ForeignKey( settings.AUTH_USER_MODEL, on_delete=models.SET(get_sentinel_user), ) models.DO_NOTHING: ä¸åšä»»ä½•æ“ä½œ limit_choices_to: é™åˆ¶è¯¥å­—æ®µä¸ºé€‰é¡¹å½¢ã€‚æ ¼å¼ï¼šlimit_choices_to={'is_staff': True}ã€‚å€¼ä¹Ÿå¯ä»¥ä¸ºå¯è°ƒç”¨å‡½æ•°ã€‚ def limit_pub_date_choices(): return {'pub_date__lte': datetime.date.utcnow()} limit_choices_to = limit_pub_date_choices related_name è®¾ç½®ä»å…³è”å¯¹è±¡åˆ°è‡ªèº«çš„å…³ç³»çš„åç§°ï¼Œè‹¥å€¼ä¸º'+' åˆ™å…³è”å¯¹è±¡ä¸è‡ªèº«æ— é€†å‘å…³ç³»ã€‚è¯¦è§£è¯·çœ‹å®˜æ–¹æ–‡æ¡£ã€‚ä¸¾ä¾‹ï¼š related_nameçš„ä½œç”¨æ˜¯åœ¨åå‘å¼•ç”¨çš„æ—¶å€™ï¼Œå°±æ˜¯é€šè¿‡Userå»æ‰¾Employeeçš„æ—¶å€™ï¼Œç”¨User.user_employeeï¼Œå¼•æ–‡å…³é”®è¯å«ï¼šreverse accessorã€‚ class Employee(generic.BO): user = models.OneToOneField(User,verbose_name=_(&quot;ç™»å½•è´¦æˆ·&quot;),blank=True,null=True,on_delete=models.CASCADE,related_name='user_employee') to_field è®¾ç½®æ‰€å…³è”å¯¹è±¡çš„å…³è”å­—æ®µã€‚é»˜è®¤ä¸ºå…³è”å¯¹è±¡çš„ä¸»é”®å­—æ®µã€‚ OneToOneFieldå’ŒForeignKeyæœ‰ä»€ä¹ˆåŒºåˆ« ManyToManyField(othermodel, **options) å¤šå¯¹å¤šå­—æ®µã€‚ othermodel: æ‰€å…³è”çš„modelåç§°; db_table: å¤šå¯¹å¤šå…³ç³»ä¼šåœ¨ä¸¤ä¸ªæ¨¡å‹æ‰€å¯¹åº”çš„è¡¨ä¸­é—´åˆ›å»ºä¸€ä¸ª'ä¸­é—´è¡¨â€™ ï¼Œå°†å¤šå¯¹å¤šè½¬æ¢ä¸ºä¸¤ä¸ªå¤šå¯¹ä¸€ï¼Œè¯¥é€‰é¡¹ä¸ºè¿™ä¸ªä¸­é—´è¡¨è®¾ç½®åç§°ã€‚ä¸€èˆ¬æ¥è¯´djangoä¼šé»˜è®¤ä¸ºä¸­é—´è¡¨åˆ›å»ºåç§°ï¼Œä½†äººä»¬è¯»èµ·æ¥å¯èƒ½æä¸æ¸…æ¥šç©¶ç«Ÿä¸­é—´è¡¨å…³è”åˆ°äº†å“ªé‡Œ; related_name: åŒå¤šå¯¹ä¸€å­—æ®µä¸­çš„related_name; limite_choices_to: åŒ....; symmetrical: å½“å¤šå¯¹å¤šå…³è”å¯¹è±¡ä¸ºè‡ªèº«æ—¶å¯èƒ½ä¼šç”¨åˆ°çš„å‚æ•°ã€‚é»˜è®¤ä¸ºTrueã€‚a,båŒå±äºpersonæ¨¡å‹ï¼Œpersonä¸­çš„friendså­—æ®µä¸è‡ªèº«è®¾ç½®äº†å¤šå¯¹å¤šå…³ç³»ï¼Œå½“è¯¥å€¼è®¾ç½®ä¸ºTrueæ—¶ï¼Œdjangoå‡å®šå…³ç³»ä¸ºå¯¹ç§°ï¼Œå³ï¼šaæ˜¯bçš„æœ‹å‹ï¼Œé‚£ä¹ˆbä¹Ÿæ˜¯açš„æœ‹å‹ã€‚è®¾ç½®ä¸ºFalseæ—¶ï¼Œdjangoä¼šå¼ºåˆ¶ä¸ºé€†å‘å…³ç³»åˆ›å»ºæè¿°ä¿¡æ¯; though: ä¸æƒ³è®©djangoè‡ªåŠ¨åˆ›å»ºä¸­é—´è¡¨ï¼Œæ‰‹åŠ¨åˆ›å»ºä¸­é—´è¡¨æ‰€å¯¹åº”çš„modelï¼Œé€šè¿‡thoughæŒ‡å®šå¯¹åº”çš„modelåç§°; though_field: å½“thoughå‚æ•°è¢«ä½¿ç”¨æ—¶ï¼Œè¯¥å‚æ•°æ‰ä¼šæœ‰æ•ˆã€‚æŒ‡å®šä½¿ç”¨å“ªäº›ä¸­é—´æ¨¡å‹å­—æ®µæ¥ç¡®ç«‹ä¸¤ä¸ªæ¨¡å‹çš„å¤šå¯¹å¤šå…³ç³»; OneToOneField(othermodel, on_delete, parent_link=False, **options) ä¸€å¯¹ä¸€å­—æ®µã€‚ othermodel: ....... on_delete:........ related_name:........... å‚è€ƒèµ„æ–™ Fail to POST OneToOneField with Django REST å‚è€ƒ å…³è” å…³è”æœªå®šä¹‰çš„Model å¦‚æœä½ è¦ä¸æŸä¸ªå°šæœªå®šä¹‰çš„modelå»ºç«‹å…³è”ï¼Œå°±ä½¿ç”¨modelçš„åç§°ï¼Œè€Œä¸æ˜¯ä½¿ç”¨modelå¯¹è±¡æœ¬èº«ã€‚ class Book(models.Model): pub = models.ForeignKey('Publisher') å…³è”è‡ªèº« å¯ä»¥ä¸è‡ªèº«å»ºç«‹å¤šå¯¹ä¸€æˆ–è€…ä¸€å¯¹ä¸€å…³ç³»ã€‚ class People(models.Model): name=models.CharField(max_length=20) leader=models.ForeignKey('self',blank=True,null=True) class Person(models.Model): friends = models.ManyToManyField(&quot;self&quot;) //é€šè¿‡shellæ·»åŠ å…³ç³» &gt;&gt;&gt;p1.friends.add(p2,p3) é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ç§å…³è”å…³ç³»æ˜¯å¯¹ç§°çš„ï¼Œå¦‚æœperson1æ˜¯person2çš„æœ‹å‹ï¼Œé‚£ä¹ˆperson2ä¹Ÿæ˜¯person1çš„æœ‹å‹ï¼Œè¦æŸ¥æ‰¾person2çš„æ‰€æœ‰æœ‹å‹å¯ä»¥ç›´æ¥ä½¿ç”¨person2.friends.all()ã€‚ å¦‚æœè¦å–æ¶ˆè¿™ç§å¯¹ç§°å…³ç³»ï¼Œå¯ä»¥å°†symmetricalè®¾ç½®ä¸ºFalseï¼š class Person2(models.Model): friends=models.ManyToManyField(&quot;self&quot;,symmetrical=False) è¿™æ ·æŸ¥è¯¢p3çš„æœ‹å‹ï¼Œå°±éœ€è¦p3.person_set.all()äº† åå‘åç§°related_name åå‘åç§°ç”¨æ¥ä»è¢«å…³è”å­—æ®µæŒ‡å‘å…³è”å­—æ®µã€‚ class Book(models.Model): name=models.CharField(max_length=20) pub=models.ForeignKey(Publisher,related_name='pub') authors=models.ManyToManyField(Author,related_name='author') è¿™æ ·ç”¨Publisheræˆ–è€…Authoråå‘æŸ¥è¯¢Bookæ—¶å¯ä»¥ç”¨related_nameäº†:publisher1.pub.all()æˆ–è€…author1.author.all()ã€‚ å¦‚æœä¸æƒ³è®¾ç½®åå‘å…³å¿ƒï¼Œåˆ™è®¾ç½®related_nameä¸º'+'æˆ–è€…ä»¥'+'ç»“æŸã€‚ user = models.ForeignKey(User, related_name='+') å¦‚æœæœ‰å¤šä¸ªManyToManyFieldæŒ‡å‘åŒä¸€ä¸ªModelï¼Œè¿™æ ·åå‘æŸ¥è¯¢FOO_setçš„æ—¶å€™å°±æ— æ³•å¼„æ¸…æ˜¯å“ªä¸ªManyToManyFieldå­—æ®µäº†ï¼Œæ‰€ä»¥å¯ä»¥ç¦æ­¢åå‘å…³ç³»ï¼š users = models.ManyToManyField(User, related_name='u+') referents = models.ManyToManyField(User, related_name='ref+') å‚è€ƒ è®¤è¯å’Œæƒé™ settings.pyè®¾ç½®é»˜è®¤çš„è®¤è¯æ–¹å¼å’Œæƒé™ã€‚ REST_FRAMEWORK = { # å…¨å±€ï¼Œé»˜è®¤è®¤è¯ 'DEFAULT_AUTHENTICATION_CLASSES': ( 'rest_framework.authentication.SessionAuthentication', 'rest_framework.authentication.BasicAuthentication', # 'rest_framework.authentication.TokenAuthentication', ), # å…¨å±€ï¼Œé»˜è®¤æƒé™ 'DEFAULT_PERMISSION_CLASSES': ( 'rest_framework.permissions.IsAuthenticated', ), } django-rest-auth django-rest-authç”¨æˆ·ç®¡ç†appï¼Œç½‘å€ ç”¨æˆ·ç®¡ç† ç™»é™† /rest-auth/login/ (POST) username email password Returns Token key ç™»å‡º /rest-auth/logout/ (POST) é‡ç½®å¯†ç  /rest-auth/password/reset/ (POST) email ç¡®è®¤å¯†ç  /rest-auth/password/reset/confirm/ (POST) uid token new_password1 new_password2 Note:uidå’Œtokenæ˜¯è¯·æ±‚é‡ç½®å¯†ç æ¥å£/rest-auth/password/reset/è¿”å›çš„ ä¿®æ”¹å¯†ç  /rest-auth/password/change/ (POST) new_password1 new_password2 old_password æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ /rest-auth/user/ (GET, PUT, PATCH) username first_name last_name Returns pk, username, email, first_name, last_name æ³¨å†Œ /rest-auth/registration/ (POST) username password1 password2 email ç¡®è®¤ /rest-auth/registration/verify-email/ (POST) key è‡ªå®šä¹‰ç”¨æˆ·è®¤è¯ BaseAuthenticationç±»ï¼š django rest-framework é€šè¿‡BaseAuthentication å®ç°è®¤è¯åŠŸèƒ½,æ— è®ºæ˜¯è‡ªå®šä¹‰çš„è®¤è¯ç±»è¿˜æ˜¯rest-frameworkè‡ªå¸¦çš„è®¤è¯ç±»éƒ½åº”è¯¥ç»§æ‰¿BaseAuthentication.BaseAuthentication ä¸­æœ‰ä¸¤ä¸ªæ–¹æ³•authenticateå’Œauthenticate_header,å…¶ä¸­authenticateæ–¹æ³•å¿…é¡»å®ç° å¦‚æœç”¨æˆ·éœ€è¦è‡ªå®šä¹‰è®¤è¯æ–¹æ³•åˆ™ç»§æ‰¿BaseAuthenticationé‡å†™authenticateæ–¹æ³•å³å¯. æ–°å»ºUserToken ä¿®æ”¹models.pyæ–‡ä»¶ï¼Œå¢å‡UserTokenç±»ï¼Œå…¶ä¸­UserInfoä¹Ÿå¯ä½¿ç”¨ç³»ç»Ÿçš„Userç±»ï¼Œå…·ä½“å¦‚ä¸‹ï¼š from django.db import models class UserInfo(models.Model): user_type_choices = ( (1, 'æ™®é€šç”¨æˆ·'), (2, 'VPI'), (3, 'SVPI'), ) user_type = models.IntegerField(choices=user_type_choices) username = models.CharField(max_length=32, unique=True) password = models.CharField(max_length=64) class UserToken(models.Model): user = models.OneToOneField('UserInfo', models.CASCADE) token = models.CharField(max_length=64) æ„å»ºè®¤è¯ä»£ç  æ‰“å¼€APP_DIR/utils/auth.pyï¼ˆè‹¥æ— ï¼Œåˆ™æ–°å»ºè¯¥æ–‡ä»¶ï¼‰ï¼Œå°†è®¤è¯ä»£ç æ”¾å…¥å…¶ä¸­ã€‚ from rest_framework import exceptions from rest_framework.authentication import BaseAuthentication from app01 import models # å®ç°è‡ªå®šä¹‰çš„è®¤è¯ç±» class Authtication(BaseAuthentication): def authenticate(self, request): # è¿™å„¿çš„ request å¯¹è±¡ä¸æ˜¯ django åŸç”Ÿçš„ request è€Œæ˜¯ rest_framework å†…éƒ¨è¿›è¡Œå°è£…è¿‡çš„ request # ä½¿ç”¨ request._request è°ƒç”¨ django åŸç”Ÿçš„ request å¯¹è±¡ token = request._request.GET.get('token') # æ£€æŸ¥ç”¨æˆ·çš„ token æ˜¯å¦åˆæ³• token_obj = models.UserToken.objects.filter(token=token).first() if not token_obj: # rest_framework ä¼šåœ¨å†…éƒ¨æ•æ‰è¿™ä¸ªå¼‚å¸¸å¹¶è¿”å›ç»™ç”¨æˆ·è®¤è¯å¤±è´¥çš„ä¿¡æ¯ raise exceptions.AuthenticationFailed('ç”¨æˆ·è®¤è¯å¤±è´¥') # åœ¨ rest_framework å†…éƒ¨ä¼šå°†è¿™ä¸¤ä¸ªå­—æ®µèµ‹å€¼ç»™requestä»¥ä¾›åç»­è°ƒç”¨ return (token_obj.user, token_obj) ä¿®æ”¹views.pyæ–‡ä»¶ from django.http import JsonResponse from rest_framework.views import APIView from app01.utils.auth import Authtication import hashlib import time # ç”Ÿæˆ token å­—ç¬¦ä¸² def md5(user): ctime = str(time.time()) m = hashlib.md5(bytes(user, encoding='utf-8')) m.update(bytes(ctime, encoding='utf-8')) return m.hexdigest() # ç”¨æˆ·ç™»å½• class AuthView(APIView): def post(self, request): ret = {'code':1000, 'msg':None} try: user = request._request.POST.get('username') pwd = request._request.POST.get('password') obj = models.UserInfo.objects.filter(username=user, password=pwd).first() if not obj: ret['code'] = 1001 ret['msg'] = &quot;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&quot; # ä¸ºç™»å½•ç”¨æˆ·åˆ›å»ºtoken token = md5(user) #å­˜åœ¨æ›´æ–° ä¸å­˜åœ¨åˆ›å»º models.UserToken.objects.update_or_create(user=obj, defaults={'token':token}) ret['token'] = token except: ret['code'] = 1002 ret['msg'] = 'è¯·æ±‚å¼‚å¸¸' return JsonResponse(ret) # ä¸šåŠ¡ä»£ç  class Order(APIView): # æ³¨å†Œè‡ªå®šä¹‰çš„è®¤è¯ç±», å¯ä»¥æœ‰å¤šä¸ª, ä»å·¦åˆ°å³è¿›è¡Œè®¤è¯åŒ¹é… authentication_classes = [Authtication,] def get(self, request): # request.user è¿™ä¸ªå€¼ç­‰äº Authtication è¿”å›çš„å…ƒç»„çš„ç¬¬ä¸€ä¸ªå€¼ # request.auth è¿™ä¸ªå€¼ç­‰äº Authtication è¿”å›çš„å…ƒç»„çš„ç¬¬äºŒä¸ªå€¼ ret = {'code':1000, 'msg':None, 'data':None} ret['data'] = 'æ¬¢è¿ä½¿ç”¨æœ¬ç³»ç»Ÿ' return JsonResponse(ret) rest_frameworkå†…ç½®çš„è®¤è¯ç±»ï¼š BasicAuthentication # åŸºäºæµè§ˆå™¨å®ç°çš„ Basic è®¤è¯, ftp ä½¿ç”¨ç½‘é¡µç™»å½•æ—¶ä½¿ç”¨çš„å°±æ˜¯ Basic è®¤è¯ SessionAuthentication # åŸºäº django çš„ user.is_active è¿›è¡Œè®¤è¯ TokenAuthentication # ç®€å•çš„åŸºäº token çš„è®¤è¯ RemoteUserAuthentication # ç®€å•çš„è¿œç¨‹ç”¨æˆ·è®¤è¯å®ç° å¯å‚è€ƒæ–‡æ¡£ï¼š Django è®¤è¯ç³»ç»Ÿ é…ç½®å…¨å±€ç”Ÿæ•ˆçš„è®¤è¯ç±»å’ŒåŒ¿åç”¨æˆ·ï¼š è‡ªå®šä¹‰çš„è®¤è¯ç±»å¦‚æœæ¯æ¬¡éƒ½åœ¨æŒ‡å®šçš„ç±»ä¸­ä½¿ç”¨authentication_classesæŒ‡å®š,å°±æœ‰å¯èƒ½å‡ºç°å¤§é‡çš„é‡å¤ä»£ç ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å…¨å±€è®¾ç½®è®©æŒ‡å®šçš„è®¤è¯ç±»å¯¹ç»§æ‰¿è‡ªAPIViewçš„æ‰€æœ‰ç±»ç”Ÿæ•ˆï¼Œä¿®æ”¹settings.pyæ–‡ä»¶ã€‚ REST_FRAMEWORK = { # è®¾ç½®å…¨å±€ç”Ÿæ•ˆçš„è®¤è¯ç±»(å¯ä»¥æœ‰å¤šä¸ª) # app01 ä¸º django app çš„åç§° # utils ä¸º app ç›®å½•ä¸‹é¢çš„ utils ç›®å½•(è¿™ä¸ªç›®å½•å¿…é¡»åŒ…å« __init__.py æ–‡ä»¶) # auth ä¸º utils ç›®å½•ä¸‹é¢çš„ auth.py æ–‡ä»¶ # Authtication ä¸º auth.py æ–‡ä»¶é‡Œé¢çš„ Authtication ç±» # è¿™å„¿çš„è®¾ç½®å…¶å®å°±æ˜¯ä½¿ç”¨ from ... import ... çš„è·¯å¾„ 'DEFAULT_AUTHENTICATION_CLASSES': [&quot;app01.utils.auth.Authtication&quot;,], #åŒ¿åç”¨æˆ·é…ç½® 'UNAUTHENTICATED_USER': None, # è®¾ç½®åŒ¿åç”¨æˆ·çš„ç”¨æˆ·å, é»˜è®¤ä¸º AnonymousUser, ä½¿ç”¨ request.user æŸ¥çœ‹ 'UNAUTHENTICATED_TOKEN': None, # è®¾ç½®åŒ¿åç”¨æˆ·çš„ token, é»˜è®¤ä¸º None, ä½¿ç”¨ request.auth æŸ¥çœ‹ } æŒ‡å®šViewç±»ä¸ä½¿ç”¨å…¨å±€çš„è®¤è¯ç±»ï¼š åœ¨ä¸ä½¿ç”¨å…¨å±€è®¤è¯ç±»çš„Viewç±»ä¸­æ·»åŠ authentication_classes = []æˆ–è€…``authentication_classes = ['xxxx']` # authentication_classes = [] è¡¨ç¤ºä¸ä½¿ç”¨è®¤è¯ # authentication_classes = ['xxxx'], xxxx è¡¨ç¤ºå½“å‰ç±»éœ€è¦ä½¿ç”¨çš„è®¤è¯ç±»ç”¨äºæ›¿æ¢å…¨å±€ç±» å‚è€ƒé“¾æ¥ é”™è¯¯ Django Rest Framework - â€œdetailâ€: â€œNot found.â€` é‡åˆ°çš„æƒ…å†µæ˜¯urlè¢«å…¶ä»–è·¯ç”±æ‹¦æˆªã€‚ Djangoï¼šCSRF Failed: CSRF token missing or incorrect ç™»é™†æˆåŠŸåä¸€ç›´è¿”å›Djangoï¼šCSRF Failed: CSRF token missing or incorrectå…¶å®ä¸æ˜¯è·¨åŸŸé—®é¢˜ï¼Œè€Œæ˜¯Djangoè‡ªå¸¦çš„ç”¨æˆ·éªŒè¯æœºåˆ¶å¯¼è‡´ï¼Œä¸ºæ­¤æˆ‘ä»¬éœ€è¦åœ¨è¯·æ±‚å¤´é‡æ·»åŠ X-CSRFToken,æ­¥éª¤å¦‚ä¸‹ï¼šå°†Postmanè¿”å›çš„cookieä¸­çš„csrftokenå€¼å¤åˆ¶åˆ°è¯·æ±‚å¤´ä¸­ï¼Œ KEY VALUE X-CSRFToken cookieä¸­çš„tokenå€¼ ä¹‹åæäº¤è¯·æ±‚å³å¯ã€‚ å®˜ç½‘é“¾æ¥ ç®€åŒ–djangoçš„å…«ä¸ªpythonåŒ… å‚è€ƒèµ„æ–™ æ•°æ®æŸ¥è¯¢ django queryset å®ç°åŸºæœ¬çš„å¢åˆ æ”¹æŸ¥ç­‰ã€‚ Django QuerySet æ–¹æ³•æ¢³ç† å¸¸ç”¨ Django QuerySet Api django_filter å®ç°å®šåˆ¶åŒ–çš„æŸ¥è¯¢åŠŸèƒ½ï¼Œå¯å¯¹ä¸åŒå­—æ®µè¿›è¡Œç²¾ç¡®å’Œæ¨¡ç³ŠæŸ¥è¯¢ã€‚ pypyå®˜ç½‘ å®˜æ–¹æ–‡æ¡£ ç”¨django-filterå®ç°é«˜çº§æœç´¢ å¤–é”® serializer è‡ªåŠ¨åºåˆ—åŒ–å¤–é”®æ—¶ä¼šé‡åˆ°ä¸€äº›é—®é¢˜ã€‚ å‚è€ƒæ–‡çŒ® DRF 3 - Creating Many-to-Many update/create serializer with though table DRF: Simple foreign key assignment with nested serializers? manytomany ä¿å­˜æ–¹å¼ # ç›´æ¥ä¿å­˜å¤šå¯¹å¤šå…³ç³» def create(self, validated_data): if validated_data.get('help_poor'): help_poor_datas = validated_data.pop('help_poor') activity_arrangement = ActivityArrangement.objects.create(**validated_data) for help_poor_data in help_poor_datas: help_poor = HelpPoor.objects.create(**help_poor_data) activity_arrangement.help_poor.add(help_poor) else: activity_arrangement = ActivityArrangement.objects.create(**validated_data) return activity_arrangement æ•°æ®åº“ æ•°æ®åº“è¿æ¥ djangoè¿æ¥mongodbæ•°æ®åº“ å‚è€ƒæ–‡çŒ® Django MongoDB Engine mongoæ•°æ®åº“å®˜æ–¹æ–‡æ¡£ model migrate é—®é¢˜ django migrate error: table 'xxx' already exists å¤šä¸ºç§»åº“åï¼Œåº“è¡¨ä¸migrationæ–‡ä»¶ä¸ç¬¦é€ æˆï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è§£å†³ã€‚ python manage.py migrate --fake &lt;appname&gt; å‚è€ƒæ–‡çŒ® å‚è€ƒ stack over flow æ•°æ®åº“è¿ç§» slqlite3è¿ç§»mysql æ•°æ®åº“çš„è¿ç§»æ–¹æ³•é’ˆå¯¹ä¸åŒæ•°æ®åº“ï¼Œå¦‚ SQLite3, MySQL, PostgreSQL ä¹‹é—´æ•°æ®è¿ç§»æ–¹æ¡ˆï¼Œä»¥åŠæ•°æ®åœ¨ä¸åŒæœºå™¨ä¸Šè¿ç§»æ–¹æ¡ˆ ç®€å•çš„æ•°æ®å¯¼å‡ºä¸å¯¼å…¥ï¼ˆç®€å•çš„è¿ç§»ï¼‰ django é¡¹ç›®æä¾›äº†ä¸€ä¸ªå¯¼å‡ºçš„æ–¹æ³• python manage.py dumpdata, ä¸æŒ‡å®š appnameæ—¶é»˜è®¤ä¸ºå¯¼å‡ºæ‰€æœ‰çš„app python manage.py dumpdata [appname] &gt; appname_data.json æ¯”å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªé¡¹ç›®å«mysite, é‡Œé¢æœ‰ä¸€ä¸ªappå«blog,æˆ‘ä»¬æƒ³å¯¼å‡ºblogçš„æ‰€æœ‰æ•°æ® python manage.py dumpdata blog &gt; blog_dump.json æ•°æ®å¯¼å…¥,ä¸éœ€è¦æŒ‡å®šappname python manage.py loaddata blog_dump.json ! ! ! æ³¨æ„: ä½¿ç”¨è¯¥æ–¹æ³•è§£å†³é—®é¢˜ï¼Œç¼ºå°‘è¡¨æ—¶æ‰‹åŠ¨æ·»åŠ åº“è¡¨ å¤‡æ³¨ï¼šä¸€äº›å¸¸ç”¨çš„ python manage.py dumpdata auth &gt; auth.json # å¯¼å‡ºç”¨æˆ·æ•°æ® ä¼˜ç‚¹ï¼šå¯ä»¥å…¼å®¹å„ç§æ”¯æŒçš„æ•°æ®åº“ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä»¥å‰ç”¨çš„æ˜¯SQLite3ï¼Œå¯ä»¥å¯¼å‡ºåï¼Œç”¨è¿™ç§æ–¹æ³•å¯¼å…¥åˆ°MySQL, PostgreSQLç­‰æ•°æ®åº“ï¼Œåè¿‡æ¥ä¹Ÿå¯ä»¥ã€‚ ç¼ºç‚¹ï¼šæ•°æ®é‡å¤§çš„æ—¶å€™ï¼Œé€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢ï¼Œè¡¨çš„å…³ç³»æ¯”è¾ƒå¤æ‚çš„æ—¶å€™å¯ä»¥å¯¼å…¥ä¸æˆåŠŸã€‚ å¦‚æœä½ è¿æ°”å¥½çš„è¯å¯èƒ½ä¼šå¯¼å…¥å®Œæˆï¼Œä½†æ˜¯å¾€å¾€ä¸é‚£ä¹ˆé¡ºåˆ©ï¼ŒåŸå› å¦‚ä¸‹ï¼š a) æˆ‘ä»¬åœ¨å†™modelsçš„æ—¶å€™å¦‚æœç”¨åˆ°CharField,å°±ä¸€å®šè¦å†™max_length,åœ¨sqlite3ä¸­æ˜¯ä¸æ£€æŸ¥è¿™ä¸ªæœ€å¤§é•¿åº¦çš„ï¼Œä½ å†™æœ€å¤§å…è®¸é•¿åº¦ä¸º100ï¼Œä½ å¾€æ•°æ®åº“æ”¾10000ä¸ªï¼Œsqlite3éƒ½ä¸æŠ¥é”™ï¼Œè€Œä¸”ä¸æˆªæ–­æ•°æ®çš„é•¿åº¦ï¼Œè¿™ä¼¼ä¹æ˜¯slite3çš„ä¼˜ç‚¹ï¼Œä½†æ˜¯ä¹Ÿç»™ä»sqlite3å¯¼å…¥å…¶å®ƒæ•°æ®åº“å¸¦æ¥äº†å›°éš¾,å› ä¸ºMySQLå’ŒPostgreSQLæ•°æ®åº“éƒ½ä¼šæ£€æŸ¥æœ€å¤§é•¿åº¦ï¼Œè¶…å‡ºæ—¶å°±æŠ¥é”™ï¼ b) Django è‡ªå¸¦çš„contentTypeä¼šå¯¼è‡´å‡ºç°ä¸€äº›é—®é¢˜ ç”¨ä¸Šé¢çš„æ–¹æ³•åªè¿ç§»ä¸€ä¸ªappåº”è¯¥é—®é¢˜ä¸å¤§ï¼Œä½†æ˜¯å¦‚æœæœ‰ç”¨æˆ·ï¼Œç”¨æˆ·ç»„æŒ‚é’©ï¼Œäº‹æƒ…å¾€å¾€å˜å¾—ç³Ÿç³•ï¼å¦‚æœå¯¼å…¥åæ²¡æœ‰å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œä½ å¯ä»¥è€ƒè™‘é‡æ–°å¯¼å…¥ï¼Œå¯èƒ½è¿˜è¦å¿«ä¸€äº›ï¼Œå¦‚æœæ˜¯æ‰‹åŠ¨åœ¨åå°è¾“å…¥æˆ–è€…ä¿®æ”¹è¿‡ï¼Œè¿™ç§æ–¹æ³•å°±ä¸é€‚ç”¨äº† å‚è€ƒæ–‡çŒ® è‡ªå¼ºå­¦å ‚ é—®é¢˜ Django 2.0 SQLite3 to MySQL loaddata error: â€œThe database backend does not accept 0 as a value for AutoField.â€ //For illustration in datadump_3-7-18.json: [ { //&lt;----- I GOT DELETED &quot;model&quot;: &quot;inventory.bike&quot;, //&lt;----- I GOT DELETED &quot;pk&quot;: 0, //&lt;----- I GOT DELETED &quot;fields&quot;: { //&lt;----- I GOT DELETED //... //&lt;----- I GOT DELETED } //&lt;----- I GOT DELETED }, //&lt;----- I GOT DELETED { &quot;model&quot;: &quot;inventory.bike&quot;, &quot;pk&quot;: 1, &quot;fields&quot;: { //... } }, { &quot;model&quot;: &quot;inventory.bike&quot;, &quot;pk&quot;: 2, &quot;fields&quot;: { //... } } ] stackoverflow ä»viewåˆ°viewset djangoä½¿ç”¨Viewï¼Œ django-rest-framework(æ¦‚å¿µç¯‡)â€”â€”apiview&amp;viewset åˆ†é¡µ åœ¨drfä¸­å¯¹äºæ•°æ®çš„è¿”å›æ”¯æŒå¤šç§åˆ†é¡µæŠ€å·§ï¼Œåœ¨å®˜ç½‘ä¸­ä¸»è¦å‘æˆ‘ä»¬ä»‹ç»äº†PageNumberPaginationã€LimitOffsetPaginationã€CursorPaginationã€‚ é…ç½®å…¨å±€åˆ†é¡µ é‡‡ç”¨å…¨å±€é…ç½®éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®ï¼Œä¾‹å¦‚å°†å…¨å±€åˆ†é¡µè®¾ç½®ä¸ºPageNumberPaginationï¼Œéœ€è¦åœ¨base.pyä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š REST_FRAMEWORK = { 'DEFAULT_PAGINATION_CLASS': 'rest_framework.pagination.PageNumberPagination', 'PAGE_SIZE': 100 } å•ç‹¬è®¾ç½®åˆ†é¡µ å¦‚æœéœ€è¦å¯¹æ¯ä¸ªè§†å›¾è¿›è¡Œå•ç‹¬é…ç½®ï¼Œéœ€è¦è®¾ç½®ModelViewSetä¸­çš„pagination_classå€¼ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š class MachineRoomViewSet(viewsets.ModelViewSet): &quot;&quot;&quot; æœºæˆ¿æ“ä½œè§†å›¾ &quot;&quot;&quot; queryset = MachineRoom.objects.all() serializer_class = MachineRoomSerializer pagination_class = PageNumberPagination ä¿®æ”¹åˆ†é¡µé£æ ¼ å¦‚æœä½ éœ€è¦ä¿®æ”¹åˆ†é¡µé£æ ¼ ï¼Œç³»éœ€è¦é‡å†™åˆ†é¡µç±»ï¼Œç„¶åè®¾ç½®ä½ éœ€è¦ä¿®æ”¹çš„å±æ€§ã€‚ class LargeResultsSetPagination(PageNumberPagination): page_size = 1000 page_size_query_param = 'page_size' max_page_size = 10000 class StandardResultsSetPagination(PageNumberPagination): page_size = 100 page_size_query_param = 'page_size' max_page_size = 1000 # ç„¶ååœ¨è§†å›¾ä¸­ä½¿ç”¨.pagination_classå±æ€§è°ƒç”¨è¯¥è‡ªå®šä¹‰ç±» class BillingRecordsView(generics.ListAPIView): queryset = Billing.objects.all() serializer_class = BillingRecordsSerializer pagination_class = LargeResultsSetPagination # æˆ–è€…æ˜¯åœ¨è®¾ç½®ä¸­ä¿®æ”¹DEFAULT_PAGINATION_CLASS REST_FRAMEWORK = { 'DEFAULT_PAGINATION_CLASS': 'apps.core.pagination.StandardResultsSetPagination' } pageNumberPaginationä½¿ç”¨æ–¹æ³• è¿™ä¸ªåˆ†é¡µæ ·å¼æ¥å—è¯·æ±‚æŸ¥è¯¢å‚æ•°ä¸­çš„ä¸€ä¸ªæ•°å­—é¡µé¢å·ã€‚ GET https://api.example.org/accounts/?page=4 å“åº”å¯¹è±¡ HTTP 200 OK { &quot;count&quot;: 1023 &quot;next&quot;: &quot;https://api.example.org/accounts/?page=5&quot;, &quot;previous&quot;: &quot;https://api.example.org/accounts/?page=3&quot;, &quot;results&quot;: [ â€¦ ] } Django-restframework Paginationï¼ˆåˆ†é¡µï¼‰ Django-rest-framework pagination ","link":"https://harveywxia.github.io/post/django-rest-framework-shi-yong-bi-ji/"},{"title":"Hello Gridea","content":"ğŸ‘ æ¬¢è¿ä½¿ç”¨ Gridea ï¼ âœï¸ Gridea ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ... Github Gridea ä¸»é¡µ ç¤ºä¾‹ç½‘ç«™ ç‰¹æ€§ğŸ‘‡ ğŸ“ ä½ å¯ä»¥ä½¿ç”¨æœ€é…·çš„ Markdown è¯­æ³•ï¼Œè¿›è¡Œå¿«é€Ÿåˆ›ä½œ ğŸŒ‰ ä½ å¯ä»¥ç»™æ–‡ç« é…ä¸Šç²¾ç¾çš„å°é¢å›¾å’Œåœ¨æ–‡ç« ä»»æ„ä½ç½®æ’å…¥å›¾ç‰‡ ğŸ·ï¸ ä½ å¯ä»¥å¯¹æ–‡ç« è¿›è¡Œæ ‡ç­¾åˆ†ç»„ ğŸ“‹ ä½ å¯ä»¥è‡ªå®šä¹‰èœå•ï¼Œç”šè‡³å¯ä»¥åˆ›å»ºå¤–éƒ¨é“¾æ¥èœå• ğŸ’» ä½ å¯ä»¥åœ¨ Windowsï¼ŒMacOS æˆ– Linux è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å®¢æˆ·ç«¯ ğŸŒ ä½ å¯ä»¥ä½¿ç”¨ ğ–¦ğ—‚ğ—ğ—ğ—ğ–» ğ–¯ğ–ºğ—€ğ–¾ğ—Œ æˆ– Coding Pages å‘ä¸–ç•Œå±•ç¤ºï¼Œæœªæ¥å°†æ”¯æŒæ›´å¤šå¹³å° ğŸ’¬ ä½ å¯ä»¥è¿›è¡Œç®€å•çš„é…ç½®ï¼Œæ¥å…¥ Gitalk æˆ– DisqusJS è¯„è®ºç³»ç»Ÿ ğŸ‡¬ğŸ‡§ ä½ å¯ä»¥ä½¿ç”¨ä¸­æ–‡ç®€ä½“æˆ–è‹±è¯­ ğŸŒ ä½ å¯ä»¥ä»»æ„ä½¿ç”¨åº”ç”¨å†…é»˜è®¤ä¸»é¢˜æˆ–ä»»æ„ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œå¼ºå¤§çš„ä¸»é¢˜è‡ªå®šä¹‰èƒ½åŠ› ğŸ–¥ ä½ å¯ä»¥è‡ªå®šä¹‰æºæ–‡ä»¶å¤¹ï¼Œåˆ©ç”¨ OneDriveã€ç™¾åº¦ç½‘ç›˜ã€iCloudã€Dropbox ç­‰è¿›è¡Œå¤šè®¾å¤‡åŒæ­¥ ğŸŒ± å½“ç„¶ Gridea è¿˜å¾ˆå¹´è½»ï¼Œæœ‰å¾ˆå¤šä¸è¶³ï¼Œä½†è¯·ç›¸ä¿¡ï¼Œå®ƒä¼šä¸åœå‘å‰ ğŸƒ æœªæ¥ï¼Œå®ƒä¸€å®šä¼šæˆä¸ºä½ ç¦»ä¸å¼€çš„ä¼™ä¼´ å°½æƒ…å‘æŒ¥ä½ çš„æ‰åå§ï¼ ğŸ˜˜ Enjoy~ ","link":"https://harveywxia.github.io/post/hello-gridea/"}]}